import{j as o}from"./jsx-runtime.D_zvdyIk.js";import{r as e}from"./index.DxhH1ShK.js";import{c as z}from"./utils.BnlJtBIq.js";import{A as Q}from"./index.BMZ1dBRY.js";import{m as W}from"./proxy.DplwUDe6.js";const Y=e.createContext(void 0);function Z(){const g=e.useContext(Y);if(!g)throw new Error("useHighlight must be used within a HighlightProvider");return g}function ot({ref:g,...s}){const{as:r="div",children:u,value:C,defaultValue:v,onValueChange:S,className:k,style:b,transition:d={type:"spring",stiffness:350,damping:35},hover:D=!1,click:P=!0,enabled:w=!0,controlledItems:F,disabled:U=!1,exitDelay:x=200,mode:h="children"}=s,c=e.useRef(null);e.useImperativeHandle(g,()=>c.current);const[m,I]=e.useState(C??v??null),[l,L]=e.useState(null),[H,M]=e.useState(""),O=e.useCallback(t=>{I(n=>n===t?n:t),t!==m&&S?.(t)},[m,S]),V=e.useCallback(t=>{if(!c.current)return;const n=s?.boundsOffset??{top:0,left:0,width:0,height:0},p=c.current.getBoundingClientRect(),i={top:t.top-p.top+(n.top??0),left:t.left-p.left+(n.left??0),width:t.width+(n.width??0),height:t.height+(n.height??0)};L(a=>a&&a.top===i.top&&a.left===i.left&&a.width===i.width&&a.height===i.height?a:i)},[s]),q=e.useCallback(()=>{L(t=>t===null?t:null)},[]);e.useEffect(()=>{C!==void 0?I(C):v!==void 0&&I(v)},[C,v]);const $=e.useId();e.useEffect(()=>{if(h!=="parent")return;const t=c.current;if(!t)return;const n=()=>{if(!m)return;const p=t.querySelector(`[data-value="${m}"][data-highlight="true"]`);p&&V(p.getBoundingClientRect())};return t.addEventListener("scroll",n,{passive:!0}),()=>t.removeEventListener("scroll",n)},[h,m,V]);const R=e.useCallback(t=>h==="parent"?o.jsxs(r,{ref:c,"data-slot":"motion-highlight-container",style:{position:"relative",zIndex:1},className:s?.containerClassName,children:[o.jsx(Q,{initial:!1,mode:"wait",children:l&&o.jsx(W.div,{"data-slot":"motion-highlight",animate:{top:l.top,left:l.left,width:l.width,height:l.height,opacity:1},initial:{top:l.top,left:l.left,width:l.width,height:l.height,opacity:0},exit:{opacity:0,transition:{...d,delay:(d?.delay??0)+(x??0)/1e3}},transition:d,style:{position:"absolute",zIndex:0,...b},className:z(k,H)})}),t]}):t,[h,r,s,l,d,x,b,k,H]);return o.jsx(Y.Provider,{value:{mode:h,activeValue:m,setActiveValue:O,id:$,hover:D,click:P,className:k,style:b,transition:d,disabled:U,enabled:w,exitDelay:x,setBounds:V,clearBounds:q,activeClassName:H,setActiveClassName:M,forceUpdateBounds:s?.forceUpdateBounds},children:w?R(F?u:e.Children.map(u,(t,n)=>o.jsx(_,{className:s?.itemsClassName,children:t},n))):u})}function K(g,s){return Object.keys(s).reduce((r,u)=>(g.props[u]===void 0&&(r[u]=s[u]),r),{})}function _({ref:g,as:s,children:r,id:u,value:C,className:v,style:S,transition:k,disabled:b=!1,activeClassName:d,exitDelay:D,asChild:P=!1,forceUpdateBounds:w,...F}){const U=e.useId(),{activeValue:x,setActiveValue:h,mode:c,setBounds:m,clearBounds:I,hover:l,click:L,enabled:H,className:M,style:O,transition:V,id:q,disabled:$,exitDelay:R,forceUpdateBounds:t,setActiveClassName:n}=Z(),p=s??"div",i=r,a=u??C??i.props?.["data-value"]??i.props?.id??U,N=x===a,T=b===void 0?$:b,E=k??V,j=e.useRef(null);if(e.useImperativeHandle(g,()=>j.current),e.useEffect(()=>{if(c!=="parent")return;let f,B=null;const X=w===!0||t&&w!==!1,J=()=>{if(!j.current)return;const A=j.current.getBoundingClientRect();if(X){if(B&&B.top===A.top&&B.left===A.left&&B.width===A.width&&B.height===A.height){f=requestAnimationFrame(J);return}B=A,f=requestAnimationFrame(J)}m(A)};if(N?(J(),n(d??"")):x||I(),X)return()=>cancelAnimationFrame(f)},[c,N,x,m,I,d,n,w,t]),!e.isValidElement(r))return r;const y={"data-active":N?"true":"false","aria-selected":N,"data-disabled":T,"data-value":a,"data-highlight":!0},G=l?{onMouseEnter:f=>{h(a),i.props.onMouseEnter?.(f)},onMouseLeave:f=>{h(null),i.props.onMouseLeave?.(f)}}:L?{onClick:f=>{h(a),i.props.onClick?.(f)}}:{};return P?c==="children"?e.cloneElement(i,{key:a,ref:j,className:z("relative",i.props.className),...K(i,{...y,"data-slot":"motion-highlight-item-container"}),...G,...F},o.jsxs(o.Fragment,{children:[o.jsx(Q,{initial:!1,mode:"wait",children:N&&!T&&o.jsx(W.div,{layoutId:`transition-background-${q}`,"data-slot":"motion-highlight",style:{position:"absolute",zIndex:0,...O,...S},className:z(M,d),transition:E,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{...E,delay:(E?.delay??0)+(D??R??0)/1e3}},...y})}),o.jsx(p,{"data-slot":"motion-highlight-item",style:{position:"relative",zIndex:1},className:v,...y,children:r})]})):e.cloneElement(i,{ref:j,...K(i,{...y,"data-slot":"motion-highlight-item"}),...G}):H?o.jsxs(p,{ref:j,"data-slot":"motion-highlight-item-container",className:z(c==="children"&&"relative",v),...y,...F,...G,children:[c==="children"&&o.jsx(Q,{initial:!1,mode:"wait",children:N&&!T&&o.jsx(W.div,{layoutId:`transition-background-${q}`,"data-slot":"motion-highlight",style:{position:"absolute",zIndex:0,...O,...S},className:z(M,d),transition:E,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{...E,delay:(E?.delay??0)+(D??R??0)/1e3}},...y})}),e.cloneElement(i,{style:{position:"relative",zIndex:1},className:i.props.className,...K(i,{...y,"data-slot":"motion-highlight-item"})})]},a):r}export{ot as H,_ as a};
