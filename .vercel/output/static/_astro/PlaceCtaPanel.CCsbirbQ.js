import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.DxhH1ShK.js";import{R as N,T as S,a as E,b as C}from"./index.lB0MAAV6.js";import{g as I}from"./index.B-oIZhPt.js";import{c as T}from"./utils.BnlJtBIq.js";import{c as p}from"./confetti.module.Cx83yTHA.js";import{N as M}from"./NumberFlow-client-48rw3j0J.DO-Ted3l.js";import{U,S as h}from"./UserStar.CAeKCGgw.js";import{u as A}from"./useDrag.C9I1mCaR.js";import{D as R,H as P}from"./index.CeIpCxKj.js";import{g as V,i as _}from"./demo.DsLEr97b.js";import{m as $}from"./proxy.D4YeN7SK.js";import"./index.VlIKThXs.js";import"./slot.DPiB-jfz.js";import"./index.CqUFkXl9.js";import"./index.DpebaNh_.js";import"./index.DXWCtkbr.js";import"./index.BI6QXNvC.js";import"./Link.DQs8_5h1.js";import"./ElectricBorder.DAWLx7iV.js";import"./Tooltip.Cp89g2lg.js";import"./index.CG_O7YBG.js";import"./virtual.VUcB3V37.js";import"./client.B9YBqyHK.js";const g=r.memo(({userData:t,className:m})=>{const[{opacity:o},f]=A({type:"user-star",item:()=>t,collect:u=>({opacity:u.isDragging()?.4:1})});return e.jsx("div",{ref:f,"data-testid":t.nickname,className:`cursor-move inline-block opacity-${o} ${m||""}`,children:e.jsx("div",{className:"relative w-10 h-10 mr-10 -mt-10 border-transparent",children:e.jsx(U,{x:0,y:0,src:t.src,alt:t.alt,nickname:t.nickname,sunshines:t.sunshines,stars:t.stars,role:t.role,funded:t.funded,received:t.received,issuesClosed:t.issuesClosed,issuesActive:t.issuesActive,uri:t.uri,walletAddress:t.walletAddress,githubUrl:t.githubUrl,linkedinUrl:t.linkedinUrl,tags:t.tags,disableTooltip:!0,disableEllipses:!0})})})});g.displayName="DraggableUserStar";const oe=({userData:t})=>{const[m,o]=r.useState(!1),[f,u]=r.useState(t?.x!==void 0&&t?.y!==void 0),[x,w]=r.useState(3),[v,b]=r.useState(!0),[d,y]=r.useState(!1),j=()=>{if(m)return;o(!0);const s=3e3,a=Date.now()+s,i={startVelocity:30,spread:360,ticks:60,zIndex:0};function n(l,c){return Math.random()*(c-l)+l}const k=setInterval(function(){const l=a-Date.now();if(l<=0){clearInterval(k),o(!1);return}const c=50*(l/s);p({...i,particleCount:c,origin:{x:n(.1,.3),y:Math.random()-.2}}),p({...i,particleCount:c,origin:{x:n(.7,.9),y:Math.random()-.2}})},250)};return r.useEffect(()=>{if(!t||!t.userId)return;const s=async a=>{if(a.detail?.userId===t.userId){const n=V();n.email&&await _({email:n.email,expectedStep:8}),u(!0),y(!0),j()}};return window.addEventListener(h.USER_STAR_MOVED,s),()=>window.removeEventListener(h.USER_STAR_MOVED,s)},[t]),r.useEffect(()=>{if(!d)return;const s=setInterval(()=>{w(a=>{const i=a-.1;return i<=0?(clearInterval(s),setTimeout(()=>b(!1),300),0):i})},100);return()=>clearInterval(s)},[d]),t?t.x!==void 0&&t.y!==void 0||!v?null:e.jsxs($.div,{className:T("relative w-full max-w-2xl mx-auto mt-12","backdrop-blur-md bg-white/20 dark:bg-slate-900/20","border border-slate-200/30 dark:border-slate-700/30","rounded-lg p-8","overflow-hidden"),initial:{opacity:0,scale:.9},animate:{opacity:d?1-(3-x)/3:1,scale:1},transition:{duration:.3},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:Array.from({length:20}).map((s,a)=>e.jsx("div",{className:"absolute w-1 h-1 bg-yellow-400 rounded-full animate-twinkle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${1+Math.random()*2}s`}},a))}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-6",children:f?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-200 text-center",children:"You placed your star, congratulations. Share the project."}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:I({iconType:"star",className:"w-16 h-16 text-yellow-500 dark:text-yellow-500/90",fill:"currentColor"})}),d&&e.jsxs("div",{className:"w-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("span",{children:"Closing in..."}),e.jsxs("span",{className:"font-semibold",children:[Math.ceil(x),"s"]})]}),e.jsxs(N,{value:[x],max:3,min:0,step:.1,disabled:!0,className:"relative flex h-5 w-full touch-none select-none items-center",children:[e.jsx(S,{className:"relative h-2 grow rounded-full bg-slate-200 dark:bg-slate-700",children:e.jsx(E,{className:"absolute h-full rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 transition-all duration-100"})}),e.jsx(C,{className:"relative block h-5 w-5 rounded-full bg-yellow-400 dark:bg-yellow-500 shadow-md ring-2 ring-yellow-300 dark:ring-yellow-600 transition-all"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-200 text-center",children:"Add your star on the page! âœ¨"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(R,{backend:P,children:e.jsx(g,{userData:t})}),e.jsx(M,{value:t.stars,locales:"en-US",className:"text-4xl font-bold text-slate-500 dark:text-yellow-500/70 -mt-2",format:{style:"decimal",maximumFractionDigits:6,minimumFractionDigits:2}})]}),e.jsx("p",{className:"text-lg text-center text-slate-700 dark:text-slate-300 mt-4",children:e.jsx("span",{className:"text-base",children:"Drag and drop your star to the page."})})]})}),e.jsx("style",{children:`
        @keyframes twinkle {
          0%, 100% {
            opacity: 0;
            transform: scale(0);
          }
          50% {
            opacity: 1;
            transform: scale(1);
          }
        }
        .animate-twinkle {
          animation: twinkle 2s ease-in-out infinite;
        }
      `})]}):e.jsx("div",{className:"mt-12 text-center text-slate-700 dark:text-slate-200",children:"You didn't obtain any stars yet - consider collaborating on this project first."})};export{oe as default};
