import{I as c,a as i}from"./issue.CJErfNqu.js";import{a as r}from"./virtual.VUcB3V37.js";import{i as o}from"./demo.DsLEr97b.js";function n(t){window.dispatchEvent(new CustomEvent(c.ISSUE_UPDATE,{detail:t}))}function d(t){window.dispatchEvent(new CustomEvent(c.ISSUE_CREATED,{detail:t}))}function f(){window.dispatchEvent(new CustomEvent(c.ISSUE_UNPATCHED))}async function I(t,e){let s=[];return e===i.SHINING?s=(await r.getShiningIssues({galaxyId:t})).data?.data||[]:e===i.PUBLIC?s=(await r.getPublicBacklogIssues({galaxyId:t})).data?.data||[]:s=(await r.getIssuesByGalaxy({galaxyId:t,tabKey:e})).data?.issues||[],s}async function a(t){try{const e=await r.getIssueById({issueId:t});return e.data?.success&&e.data.data?e.data.data:null}catch(e){return console.error("Error getting issue by id:",e),null}}async function y(t){try{if((await r.createIssue(t)).data?.success){const s=await I(t.galaxyId,t.sunshines>0?i.SHINING:i.PUBLIC),u=s.find(l=>l.title===t.title&&l.author===t.userId)||s[s.length-1];if(u)return d(u),await o({email:t.email,expectedStep:1}),u}return null}catch(e){return console.error("Error creating issue:",e),null}}async function p(t){try{if((await r.updateIssue(t)).data?.success){const s=await a(t.issueId);return s&&n(s),!0}return!1}catch(e){return console.error("Error updating issue:",e),!1}}async function g(t){try{if((await r.patchIssue(t)).data?.success){const s=await a(t.issueId);return s&&n(s),await o({email:t.email,expectedStep:4}),!0}return!1}catch(e){return console.error("Error patching issue:",e),!1}}async function S(t){try{return(await r.unpatchIssue(t)).data?.success?(f(),!0):!1}catch(e){return console.error("Error unpatching issue:",e),!1}}async function C(t){try{if((await r.updateIssueSunshines(t)).data?.success){const s=await a(t.issueId);return s&&n(s),!0}return!1}catch(e){return console.error("Error updating issue sunshines:",e),!1}}async function U(t){try{if((await r.setContributor(t)).data?.success){const s=await a(t.issueId);return s&&n(s),await o({email:t.email,expectedStep:2}),!0}return!1}catch(e){return console.error("Error setting contributor:",e),!1}}async function b(t){try{if((await r.unsetContributor(t)).data?.success){const s=await a(t.issueId);return s&&n(s),!0}return!1}catch(e){return console.error("Error unsetting contributor:",e),!1}}export{I as a,S as b,y as c,p as d,C as e,a as g,g as p,U as s,b as u};
