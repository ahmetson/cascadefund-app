import{r as o}from"./index.DxhH1ShK.js";import{a as y,u as A}from"./index.VlIKThXs.js";function E(n,e){return o.useReducer((t,r)=>e[t][r]??t,n)}var S=n=>{const{present:e,children:t}=n,r=v(e),a=typeof t=="function"?t({present:r.isPresent}):o.Children.only(t),u=y(r.ref,T(a));return typeof t=="function"||r.isPresent?o.cloneElement(a,{ref:u}):null};S.displayName="Presence";function v(n){const[e,t]=o.useState(),r=o.useRef(null),a=o.useRef(n),u=o.useRef("none"),f=n?"mounted":"unmounted",[m,s]=E(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return o.useEffect(()=>{const i=p(r.current);u.current=m==="mounted"?i:"none"},[m]),A(()=>{const i=r.current,d=a.current;if(d!==n){const N=u.current,c=p(i);n?s("MOUNT"):c==="none"||i?.display==="none"?s("UNMOUNT"):s(d&&N!==c?"ANIMATION_OUT":"UNMOUNT"),a.current=n}},[n,s]),A(()=>{if(e){let i;const d=e.ownerDocument.defaultView??window,l=c=>{const M=p(r.current).includes(CSS.escape(c.animationName));if(c.target===e&&M&&(s("ANIMATION_END"),!a.current)){const O=e.style.animationFillMode;e.style.animationFillMode="forwards",i=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=O)})}},N=c=>{c.target===e&&(u.current=p(r.current))};return e.addEventListener("animationstart",N),e.addEventListener("animationcancel",l),e.addEventListener("animationend",l),()=>{d.clearTimeout(i),e.removeEventListener("animationstart",N),e.removeEventListener("animationcancel",l),e.removeEventListener("animationend",l)}}else s("ANIMATION_END")},[e,s]),{isPresent:["mounted","unmountSuspended"].includes(m),ref:o.useCallback(i=>{r.current=i?getComputedStyle(i):null,t(i)},[])}}function p(n){return n?.animationName||"none"}function T(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function I(n){const{value:e,defaultValue:t,onChange:r}=n,[a,u]=o.useState(e!==void 0?e:t);o.useEffect(()=>{e!==void 0&&u(e)},[e]);const f=o.useCallback((m,...s)=>{u(m),r?.(m,...s)},[r]);return[a,f]}export{S as P,I as u};
