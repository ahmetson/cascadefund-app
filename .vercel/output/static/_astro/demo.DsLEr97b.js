import{a as n}from"./virtual.VUcB3V37.js";const o={email:"demo-email",users:"demo-users",role:"demo-role"},a={USER_CREATED:"demo-user-created",USER_DELETED:"demo-user-deleted",ROLE_CHANGED:"demo-role-change",DEMO_STEP_INCREMENTED:"demo-step-incremented"},h=()=>m(),S=()=>c(),g=async t=>{const e=await p(t);if(e.success&&e.users){const s="maintainer";l(t.trim(),e.users,s),window.dispatchEvent(new CustomEvent(a.USER_CREATED,{detail:{email:t.trim(),users:e.users,role:s}}))}return e},C=()=>{E(),window.dispatchEvent(new CustomEvent(a.USER_DELETED,{detail:{}}))},w=t=>{const{email:e,users:s}=c();e&&s&&(l(e,s,t),window.dispatchEvent(new CustomEvent(a.ROLE_CHANGED,{detail:{role:t}})))},R=t=>{const{email:e,role:s}=c();e&&s&&l(e,t,s)},_=async t=>{try{const e=await n.getDemoStep({email:t});return e.data?.success&&e.data.step!==void 0?e.data.step:null}catch(e){return console.error("Error getting demo step:",e),null}},v=async t=>{try{const e=await n.obtainSunshines(t);return e.data?.success?{success:!0,sunshines:e.data.sunshines,totalSunshines:e.data.totalSunshines}:{success:!1,error:e.data?.error||"Failed to obtain sunshines"}}catch(e){return console.error("Error obtaining sunshines:",e),{success:!1,error:"An error occurred while obtaining sunshines"}}},T=async t=>{try{const e=await n.incrementDemoStep(t);return console.log("incrementDemoStep result:",e,` for the ${t.expectedStep} step`),e.data?.success&&e.data.step!==void 0?(window.dispatchEvent(new CustomEvent(a.DEMO_STEP_INCREMENTED,{detail:{step:e.data.step}})),{success:!0,step:e.data.step}):{success:!1,error:e.data?.error||"Failed to increment demo step"}}catch(e){return console.error("Error incrementing demo step:",e),{success:!1,error:"An error occurred while incrementing demo step"}}};function c(){const t=i(o.email),e=i(o.users),s=i(o.role);let r=null;if(e)try{r=JSON.parse(e)}catch{r=null}return{email:t,users:r,role:s}}function m(){const{email:t,users:e,role:s}=c();return!!(t&&e&&s)}function E(){Object.values(o).forEach(t=>{f(t)})}function l(t,e,s,r=30){u(o.email,t,r),u(o.users,encodeURIComponent(JSON.stringify(e)),r),u(o.role,s,r)}async function p(t){try{const e=await n.start({email:t.trim()});return e.data?{success:!0,users:e.data.users}:{success:!1,error:e.error?.message||"Failed to start demo"}}catch(e){return console.error("Error calling start action:",e),{success:!1,error:"An error occurred while starting demo"}}}function i(t){if(typeof document>"u")return null;const s=`; ${document.cookie}`.split(`; ${t}=`);return s.length===2?decodeURIComponent(s.pop()?.split(";").shift()||""):null}function u(t,e,s=30){if(typeof document>"u")return;const r=new Date;r.setDate(r.getDate()+s);const d=r.toUTCString();document.cookie=`${t}=${e}; expires=${d}; path=/`}function f(t){typeof document>"u"||(document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`)}export{a as D,_ as a,C as b,w as c,h as d,S as g,T as i,v as o,g as s,R as u};
