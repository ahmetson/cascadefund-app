import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.DxhH1ShK.js";import{C as Qe}from"./Tabs.uf9ot-DZ.js";import{B as Pe}from"./Badge.CwoN8wRJ.js";import{R as Ce}from"./roadmap.DwIP75iC.js";import{B as Xe}from"./Panel.n1yQPIfZ.js";import{P as Ze}from"./PageLikePanel.C32EveG_.js";import{B as et}from"./Button.BGGO0Gl0.js";import{C as z}from"./Tooltip.Cp89g2lg.js";import{g as K}from"./index.B-oIZhPt.js";import{P as tt,F as ne}from"./PanelStat.t9y2r0gi.js";import{N as S}from"./NumberFlow-client-48rw3j0J.DO-Ted3l.js";import{R as st,T as rt,a as at,b as nt}from"./index.lB0MAAV6.js";import{C as Te,a as Le}from"./checkbox.CoCXscxc.js";import{M as U}from"./MenuAvatar.DNnCbCL7.js";import{A as it,P as ot}from"./AvatarList.777ZjNOH.js";import{T as lt}from"./timeago-react.CCkgRyVe.js";import{L as ie}from"./LoadingSpinner.BXgrQlbF.js";import{C as ct}from"./DropTarget.BpRrzabK.js";import{D as Ae,H as _e}from"./index.CeIpCxKj.js";import{g as q,D as Me,i as dt}from"./demo.DsLEr97b.js";import{g as J,d as ut}from"./issue.CNzGGm0q.js";import{g as M}from"./user.BVCe9jQZ.js";import{u as mt,a as ft,m as ht,b as gt,r as xt,d as pt,e as bt}from"./roadmap.oaZTwDY3.js";import{P as R,a as Re}from"./patch.CbMO86LR.js";import{c as Q,t as oe}from"./utils.BnlJtBIq.js";import{u as jt}from"./useDrag.C9I1mCaR.js";import"./highlight.B9p-7OBg.js";import"./index.CG_O7YBG.js";import"./proxy.D4YeN7SK.js";import"./slot.DPiB-jfz.js";import"./index.CqUFkXl9.js";import"./eventTypes.CfSurkCl.js";import"./ripple.CLh-JuST.js";import"./accordion.CeZr6L_N.js";import"./accordion.Drwdne5y.js";import"./use-controlled-state.FkpCVSoL.js";import"./index.VlIKThXs.js";import"./index.DpebaNh_.js";import"./createLucideIcon.C1tpinp8.js";import"./PanelAction.BT-fj3Wj.js";import"./Link.DQs8_5h1.js";import"./ElectricBorder.DAWLx7iV.js";import"./index.DXWCtkbr.js";import"./index.BI6QXNvC.js";import"./virtual.VUcB3V37.js";import"./client.B9YBqyHK.js";import"./issue.CJErfNqu.js";const vt=({author:l,createdTime:g,className:D=""})=>{if(!l&&!g)return null;const C=g?typeof g=="number"?new Date(g*1e3):typeof g=="string"?new Date(g):g:null;return e.jsxs("div",{className:`flex justify-end items-center space-x-1 text-slate-600 dark:text-slate-400 gap-1 text-xs mb-2 ${D}`,children:[l&&e.jsxs(e.Fragment,{children:["By ",Array.isArray(l)?e.jsx(it,{contributors:l,showLastRating:!0}):e.jsxs(e.Fragment,{children:[e.jsx(U,{src:l?.icon,uri:l?.uri,className:"w-7! h-7!"}),l.rating&&e.jsx(ot,{...l.rating})]})]}),C&&e.jsx(lt,{datetime:C})]})},kt=l=>l==="completed"?"archived":l==="active"||l==="planned"?"complete":l==="testing"||l==="release"||l==="archived"?l:"complete",wt=({tag:l,createdTime:g,status:D,patches:C,maintainer:w,galaxy:T,_id:o})=>{const[n,X]=s.useState(kt(D)),[f,le]=s.useState(!1),[p,L]=s.useState(C),[Et,Nt]=s.useState(null),[ce,yt]=s.useState(null),[k,de]=s.useState(null),[St,ue]=s.useState(!1),[De,me]=s.useState(null),[fe,he]=s.useState(null),[B,ge]=s.useState(0),[xe,pe]=s.useState(!1),[Ve,be]=s.useState(!1),G=s.useRef(0);s.useEffect(()=>{w&&typeof w=="string"?(ue(!0),M(w).then(t=>{t&&de(t)}).catch(t=>{console.error("Error fetching maintainer:",t)}).finally(()=>{ue(!1)})):de(null)},[w]),s.useEffect(()=>{if(p.length===0){ge(0);return}pe(!0),(async()=>{try{const r=p.map(h=>J(h.id)),a=(await Promise.all(r)).reduce((h,c)=>c?h+(c.sunshines||0):h,0);ge(a)}catch(r){console.error("Error fetching sunshines from patches:",r)}finally{pe(!1)}})()},[p]);const O=s.useCallback(()=>{const t=q();if(!t)return;t.role&&he(t.role);const r=t.users?.find(d=>d.role===t.role)||t.users?.[0];r?._id?M(r._id.toString()).then(d=>{d&&me(d)}).catch(d=>{console.error("Error fetching current user:",d)}):me(null)},[]);s.useEffect(()=>{O()},[O]),s.useEffect(()=>{const t=r=>{const a=r.detail.role;a&&(he(a),O())};return window.addEventListener(Me.ROLE_CHANGED,t),()=>{window.removeEventListener(Me.ROLE_CHANGED,t)}},[O]),s.useEffect(()=>{if(!o)return;const t=d=>{const a=d,{fromVersionId:h,toVersionId:c,patch:j}=a.detail;h===o&&c!==o?L(m=>m.filter(x=>x.id!==j.id)):c===o&&h!==o&&L(m=>m.some(x=>x.id===j.id)?m:[...m,j])},r=d=>{const a=d,{versionId:h,patch:c}=a.detail;h===o&&L(j=>j.filter(m=>m.id!==c.id))};return window.addEventListener(R.PATCH_UPDATE,t),window.addEventListener(R.PATCH_REMOVED,r),()=>{window.removeEventListener(R.PATCH_UPDATE,t),window.removeEventListener(R.PATCH_REMOVED,r)}},[o]);const je=s.useMemo(()=>p.filter(t=>t.completed).length,[p]),ve=s.useMemo(()=>p.filter(t=>t.tested).length,[p]),V=s.useMemo(()=>p.length,[p]),He=s.useMemo(()=>B>0?B/180:0,[B]),Ie=t=>{switch(t){case"complete":return"bg-blue-100/10 dark:bg-blue-900/20 border-blue-300 dark:border-blue-500/30";case"testing":return"bg-amber-100/10 dark:bg-amber-900/20 border-amber-300 dark:border-amber-500/30";case"release":return"bg-teal-100/10 dark:bg-teal-900/20 border-teal-300 dark:border-teal-500/30";case"archived":return"bg-green-100/10 dark:bg-green-900/20 border-green-300 dark:border-green-500/30";default:return"bg-slate-100/10 dark:bg-slate-900/20 border-slate-300 dark:border-slate-500/30"}},Fe=s.useMemo(()=>{if(k)return{uri:k.uri||`/profile/${k._id}`,children:k.nickname||k.email?.split("@")[0]||"Unknown",icon:k.src}},[k]),H=De?._id?.toString(),Z=typeof w=="string"?w:k?._id?.toString(),b=s.useMemo(()=>fe==="maintainer"||H&&Z&&H===Z,[fe,H,Z]),Be=(t,r)=>{switch(t){case"complete":return"Move to testing";case"testing":return r?"Ready to release":"Testing in progress";case"release":return"Release";case"archived":return"Archived";default:return"Check"}},ee=V>0,Ge=ee?je===V:!1,Oe=ee?ve===V:!1,te=Ge,A=Oe,$e=n==="complete"?"Completed":"Tested",se=n==="complete"?je:ve,re=k?e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"Maintainer"}),e.jsx(U,{user:k}),e.jsx("span",{children:"is reviewing the patches."})]}):"Maintainer controls this action.",ke=(()=>{if(n==="archived")return"Version is archived";if(n==="complete"){if(!ee)return"No patches found. Add patches first";if(!te)return"All patches must be completed before testing";if(!b)return re}if(n==="testing"){if(!b)return re;if(!A)return"Mark every patch as tested to proceed"}if(n==="release"&&!b)return re})(),we=f||n==="archived"||n==="complete"&&(!b||!te)||n==="testing"&&(!b||!A)||n==="release"&&!b,$=s.useCallback(async t=>{if(!o)return!1;le(!0);try{if(await mt({versionId:o,status:t})){if(n==="complete"&&t==="testing"){const d=q();d.email&&await dt({email:d.email,expectedStep:5})}return X(t),!0}return console.error("Error updating status"),!1}catch(r){return console.error("Error calling API:",r),!1}finally{le(!1)}},[o]),Ye=async()=>{if(!(f||!o)&&n!=="archived"){if(n==="complete"){if(!b||!te)return;await $("testing");return}if(n==="testing"){if(!b||!A)return;await $("release");return}if(n==="release"){if(!b||!o)return;await pt({versionId:o,tag:l,galaxyId:T});return}}};s.useEffect(()=>{n==="testing"&&A&&!f&&b&&$("release")},[n,A,f,b,$]);const We=async(t,r,d=!1)=>{try{const a=q();if(!a.email){console.error("No demo email found");return}const h=await J(t.id);if(!h){alert("Internal error: issue not found");return}const c=h.listHistory||[],j=c.includes(Re),m=c.find(v=>v.startsWith("version-")),x=m?m.replace("version-",""):"",P=[...c.filter(v=>v!==Re&&!v.startsWith("version-")),`version-${r}`];if(!await ut({issueId:t.id,email:a.email,listHistory:P})){console.error("Failed to update issue");return}const N=p.filter(v=>v.id!==t.id),u={id:t.id,title:t.title,completed:d,tested:!1,sunshines:t.sunshines};N.push(u),await gt(r,N),x&&await xt({patchId:t.id,versionId:x}),L(N),j?window.dispatchEvent(new CustomEvent(R.PATCH_CREATED,{detail:{patch:u,versionId:r}})):x&&window.dispatchEvent(new CustomEvent(R.PATCH_UPDATE,{detail:{fromVersionId:x,toVersionId:r,patch:u}}))}catch(a){console.error("Error changing patch list:",a)}},Ee=s.memo(({patch:t})=>{const[r,d]=s.useState(t.completed||!1),[a,h]=s.useState(null),[c,j]=s.useState(null),[m,x]=s.useState(null),[_,P]=s.useState(null),[E,I]=s.useState(!1),[N,u]=s.useState(!1),[{opacity:v,isDragging:Y},F]=jt(()=>({type:"patch",item:{id:t.id,title:t.title,sunshines:t.sunshines,versionId:o||"",completed:r},collect:i=>({opacity:i.isDragging()?.4:1,isDragging:i.isDragging()})}),[t.id,t.title,t.sunshines,o,r]);s.useEffect(()=>{d(t.completed||!1)},[t.completed]),s.useEffect(()=>{I(!0),J(t.id).then(i=>{i&&h(i)}).catch(i=>{console.error("Error fetching issue:",i)}).finally(()=>{I(!1)})},[t.id]),s.useEffect(()=>{const i=q();if(i.email&&i.users&&i.role){const W=i.users.find(y=>y.role===i.role)||i.users[0];W&&W._id&&M(W._id.toString()).then(y=>{y&&j(y)}).catch(y=>{console.error("Error fetching current user:",y)})}},[]),s.useEffect(()=>{a?.contributor&&typeof a.contributor=="string"?M(a.contributor).then(i=>{i&&x(i)}).catch(i=>{console.error("Error fetching contributor:",i)}):x(null)},[a?.contributor]),s.useEffect(()=>{a?.maintainer&&typeof a.maintainer=="string"?M(a.maintainer).then(i=>{i&&P(i)}).catch(i=>{console.error("Error fetching maintainer:",i)}):P(null)},[a?.maintainer]),s.useEffect(()=>{Y?(G.current+=1,be(!0)):(G.current=Math.max(0,G.current-1),G.current===0&&be(!1))},[Y]);const ze=async()=>{if(!(N||!o)){u(!0);try{const i=!r;await ft({versionId:o,patchId:t.id,complete:i})?(d(i),L(y=>y.map(ae=>ae.id===t.id?{...ae,completed:i}:ae))):console.error("Error toggling patch completion")}catch(i){console.error("Error calling completePatch:",i)}finally{u(!1)}}},Se=c&&a?.contributor&&c._id===a.contributor,Ke=c&&a?.maintainer&&c._id===a.maintainer,qe=!(r&&(Ke||Se)||!r&&Se),Je=()=>E?e.jsx("div",{className:"text-sm",children:"Loading..."}):a?a.contributor===c?._id&&!r?e.jsx("div",{className:"text-sm",children:"You are a contributor. Mark as completed."}):a.contributor!==c?._id&&!r?e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"contributor"}),m&&e.jsx(U,{user:m}),e.jsx("span",{children:"is working on this issue :)"})]}):r&&(a.maintainer===c?._id||a.contributor===c?._id)?e.jsx("div",{className:"text-sm",children:"Unmark if the issue isn't solved"}):r&&a.maintainer!==c?._id&&a.contributor!==c?._id?e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"contributor"}),m&&e.jsx(U,{user:m}),e.jsx("span",{children:"worked."}),e.jsx("span",{children:"maintainer"}),_&&e.jsx(U,{user:_}),e.jsx("span",{children:"reviewed."})]}):e.jsx("div",{className:"text-sm",children:"Patch completion status"}):e.jsx("div",{className:"text-sm",children:"Issue not found"});return e.jsxs("div",{ref:F,"data-testid":t.id,style:{opacity:v},className:Q("cursor-move border-1 border-amber-300/80 hover:border-amber-400","dark:border-amber-400/70 dark:hover:border-amber-300/90","bg-amber-50/50 dark:bg-amber-900/20","transition-colors p-2 border-dashed rounded-md","flex items-center justify-between gap-2"),children:[e.jsx(z,{content:Je(),children:e.jsx(Te,{checked:r,disabled:qe||n!=="complete"||N,onCheckedChange:ze,className:"w-4 h-4 rounded-sm border-2 border-slate-400 dark:border-slate-600 bg-white dark:bg-slate-600 data-[state=checked]:bg-slate-600 dark:data-[state=checked]:bg-slate-400 data-[state=checked]:border-slate-600 dark:data-[state=checked]:border-slate-400 flex items-center justify-center",children:e.jsx(Le,{className:"w-3 h-3 text-white dark:text-slate-700"})})}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300 flex-1 truncate",children:oe(t.title)}),e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[K({iconType:"sunshine",className:"w-4 h-4",fill:"currentColor"}),e.jsx("span",{className:"text-xs font-semibold",children:e.jsx(S,{value:t.sunshines||0,locales:"en-US",format:{useGrouping:!1}})})]})]})});Ee.displayName="MinimalDraggablePatch";const Ne=s.memo(({patch:t})=>{const[r,d]=s.useState(!!t.tested),[a,h]=s.useState(null),[c,j]=s.useState(null),[m,x]=s.useState(!1),[_,P]=s.useState(!1);s.useEffect(()=>{x(!0),J(t.id).then(u=>{u&&h(u)}).catch(u=>{console.error("Error fetching issue:",u)}).finally(()=>x(!1))},[t.id]),s.useEffect(()=>{a?.author&&typeof a.author=="string"&&M(a.author).then(u=>{u&&j(u)}).catch(u=>console.error("Error fetching author:",u))},[a?.author]);const E=H&&a?.author&&H===a.author,I=async()=>{if(_||n!=="testing"||!E||!o)return;P(!0);const u=!r;try{await ht(o,t.id,u)&&(d(u),L(Y=>Y.map(F=>F.id===t.id?{...F,tested:u}:F)))}catch(v){console.error("Error marking tested:",v)}finally{P(!1)}},N=()=>m?e.jsx("div",{className:"text-sm",children:"Loading..."}):a?E?E&&!r?e.jsx("div",{className:"text-sm",children:"Confirm this patch is tested"}):E&&r?e.jsx("div",{className:"text-sm",children:"Unmark if testing failed"}):e.jsx("div",{className:"text-sm",children:"Testing status"}):e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"Only author"}),c&&e.jsx(U,{user:c}),e.jsx("span",{children:"can mark tested"})]}):e.jsx("div",{className:"text-sm",children:"Issue not found"});return e.jsxs("div",{className:Q("border-1 border-amber-300/80 dark:border-amber-400/70 bg-amber-50/50 dark:bg-amber-900/20","transition-colors p-2 border-dashed rounded-md","flex items-center justify-between gap-2"),children:[e.jsx(z,{content:N(),children:e.jsx(Te,{checked:r,disabled:!E||_||n!=="testing",onCheckedChange:I,className:"w-4 h-4 rounded-sm border-2 border-slate-400 dark:border-slate-600 bg-white dark:bg-slate-600 data-[state=checked]:bg-teal-600 dark:data-[state=checked]:bg-teal-500 data-[state=checked]:border-teal-600 dark:data-[state=checked]:border-teal-400 flex items-center justify-center",children:e.jsx(Le,{className:"w-3 h-3 text-white dark:text-slate-700"})})}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300 flex-1 truncate",children:oe(t.title)}),e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[K({iconType:"sunshine",className:"w-4 h-4",fill:"currentColor"}),e.jsx("span",{className:"text-xs font-semibold",children:e.jsx(S,{value:t.sunshines||0,locales:"en-US",format:{useGrouping:!1}})})]})]})});Ne.displayName="MinimalTestablePatch";const ye=s.memo(({patch:t})=>{const r=t.tested?"Tested":t.completed?"Completed":"Pending",d=t.tested?"bg-teal-100 text-teal-700 dark:bg-teal-900/40 dark:text-teal-200":t.completed?"bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-200":"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-200";return e.jsxs("div",{className:Q("cursor-not-allowed border border-dashed rounded-md p-2","bg-slate-50/50 dark:bg-slate-900/30 border-slate-200 dark:border-slate-600/70","flex items-center justify-between gap-2"),children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide",children:e.jsx("span",{className:Q("px-2 py-0.5 rounded-sm font-semibold",d),children:r})}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300 flex-1 truncate",children:oe(t.title)}),e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[K({iconType:"sunshine",className:"w-4 h-4",fill:"currentColor"}),e.jsx("span",{className:"text-xs font-semibold",children:e.jsx(S,{value:t.sunshines||0,locales:"en-US",format:{useGrouping:!1}})})]})]})});return ye.displayName="MinimalStaticPatch",e.jsxs(Ze,{interactive:!1,title:l,rightHeader:n!=="archived"&&(()=>{const t=e.jsx(et,{variant:n==="release"&&!we?"primary":"secondary",disabled:we,onClick:Ye,children:f?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ie,{})}):Be(n,A)});return ke?e.jsx(z,{content:ke,children:t}):t})(),className:`w-full ${Ie(n)} mb-4`,children:[n!=="archived"&&e.jsxs("div",{className:"w-full p-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400 text-sm",children:$e}),e.jsx(S,{value:se,locales:"en-US",format:{useGrouping:!1},className:"font-semibold text-slate-700 dark:text-slate-400 text-sm mb-0.2"})]}),e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Total Amount"}),e.jsx(S,{value:V,locales:"en-US",format:{useGrouping:!1},className:"font-semibold text-slate-700 dark:text-slate-400 text-sm mb-0.2"})]})]}),e.jsx("div",{className:"my-2",children:e.jsxs(st,{value:[se],onValueChange:()=>{},max:V,min:0,step:1,className:"relative flex h-5 w-full touch-none select-none items-center",children:[e.jsx(rt,{className:"relative h-2 grow rounded-full bg-slate-200 dark:bg-slate-700 transition-colors",children:e.jsx(at,{className:"absolute h-full rounded-full bg-slate-600 dark:bg-teal-400/50 transition-all duration-300 ease-out"})}),e.jsx(nt,{className:"relative block h-5 w-5 rounded-full bg-gray-100/50 dark:bg-slate-400/80 shadow-md ring-2 ring-slate-400/20 dark:ring-slate-500/30 hover:ring-slate-500/40 dark:hover:ring-slate-400/50 transition-all focus:outline-none focus:ring-2 focus:ring-slate-500 dark:focus:ring-slate-400",children:e.jsx(S,{value:se,locales:"en-US",format:{useGrouping:!1},className:"absolute left-1/2 -translate-x-1/2 text-xs text-slate-600 dark:text-slate-700 font-semibold"})})]})})]}),e.jsxs("div",{className:"my-6",children:[n==="complete"?e.jsxs(e.Fragment,{children:[e.jsx(z,{content:"Patches are the issues with the contributor and common agreement.",children:e.jsx(Ae,{backend:_e,children:e.jsx(ct,{id:`version-${o||"unknown"}`,accept:["patch","issue"],onDrop:t=>{if(!o)return;const r=t.completed!==void 0?t.completed:!1;We(t,o,r)},disabled:Ve,children:e.jsxs("h4",{className:"text-sm mb-2 font-medium text-slate-700 dark:text-slate-400 flex items-center gap-1.5 cursor-help",children:[K({iconType:"info",className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),"Patches"]})})},o)}),e.jsx(Ae,{backend:_e,children:e.jsx("ul",{className:"space-y-2 min-h-[100px] mb-2",children:p.map(t=>e.jsx("li",{children:e.jsx(Ee,{patch:t})},t.id))})},`${o}-draggable`)]}):n==="testing"?e.jsx("ul",{className:"space-y-2 min-h-[100px] mb-2",children:p.map(t=>e.jsx("li",{children:e.jsx(Ne,{patch:t})},t.id))}):e.jsx("ul",{className:"space-y-2 min-h-[100px] mb-2",children:p.map(t=>e.jsx("li",{children:e.jsx(ye,{patch:t})},t.id))}),ce&&e.jsx("div",{className:"mt-4 p-3 bg-green-50/10 border border-green-200 dark:border-green-700 rounded-xs text-green-700 dark:text-green-400 text-sm",children:ce}),e.jsx(vt,{author:Fe,createdTime:g})]}),e.jsxs(tt,{children:[e.jsx(ne,{iconType:"sunshine",hint:"Total sunshines from all patches",fill:!0,children:xe?e.jsx(ie,{}):e.jsx(S,{value:B,locales:"en-US",format:{useGrouping:!0}})}),e.jsx(ne,{iconType:"star",hint:"Stars calculated from sunshines (sunshines / 180)",fill:n==="archived",children:xe?e.jsx(ie,{}):e.jsx(S,{value:He,locales:"en-US",format:{useGrouping:!1,minimumFractionDigits:1,maximumFractionDigits:1}})}),e.jsx(ne,{iconType:n==="archived"?"star":"project",hint:"Version status",fill:n==="archived",children:n==="archived"?"Archived":n})]})]})},Ue=({versions:l})=>e.jsx(Xe,{className:"space-y-6 p-0! border-none! min-h-[50vh]",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:l.map(g=>e.jsx(wt,{...g},g._id))})}),ks=({galaxyId:l})=>{const[g,D]=s.useState([]),[C,w]=s.useState(!0),T=s.useCallback(async()=>{try{w(!0);const f=await bt(l);D(f)}catch(f){console.error("Error fetching versions:",f)}finally{w(!1)}},[l]);s.useEffect(()=>{l&&T()},[l,T]),s.useEffect(()=>{const f=()=>{T()};return window.addEventListener(Ce.VERSION_CREATED,f),()=>{window.removeEventListener(Ce.VERSION_CREATED,f)}},[T]);const o=g.filter(f=>f.status!=="archived"),n=g.filter(f=>f.status==="archived");if(C)return e.jsx("div",{className:"text-center py-8",children:"Loading roadmap..."});const X=[{label:e.jsxs("div",{className:"",children:["Roadmap ",e.jsx(Pe,{variant:"gray",children:o.length})]}),key:"roadmap",content:e.jsx(Ue,{versions:o})},{label:e.jsxs("div",{className:"",children:["Archive ",e.jsx(Pe,{variant:"gray",children:n.length})]}),key:"archive",content:e.jsx(Ue,{versions:n})}];return e.jsx(Qe,{activeTab:"roadmap",tabs:X})};export{ks as default};
