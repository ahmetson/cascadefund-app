import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r,R as z}from"./index.DxhH1ShK.js";import{P as B}from"./PageLikePanel.C32EveG_.js";import{C as H}from"./Link.DQs8_5h1.js";import{B as Y}from"./Button.BGGO0Gl0.js";import{g as h}from"./index.B-oIZhPt.js";import{N as u}from"./NumberFlow-client-48rw3j0J.DO-Ted3l.js";import{R as T}from"./roadmap.DwIP75iC.js";import{s as $}from"./all-stars.DwU73iD6.js";import{g as q}from"./user.BVCe9jQZ.js";import{M as U}from"./MenuAvatar.DNnCbCL7.js";import{c as w}from"./utils.BnlJtBIq.js";import{c as D}from"./confetti.module.Cx83yTHA.js";import"./Panel.n1yQPIfZ.js";import"./eventTypes.CfSurkCl.js";import"./ripple.CLh-JuST.js";import"./slot.DPiB-jfz.js";import"./index.CqUFkXl9.js";import"./proxy.D4YeN7SK.js";import"./accordion.CeZr6L_N.js";import"./accordion.Drwdne5y.js";import"./use-controlled-state.FkpCVSoL.js";import"./index.VlIKThXs.js";import"./index.DpebaNh_.js";import"./index.CG_O7YBG.js";import"./createLucideIcon.C1tpinp8.js";import"./PanelAction.BT-fj3Wj.js";import"./ElectricBorder.DAWLx7iV.js";import"./virtual.VUcB3V37.js";import"./client.B9YBqyHK.js";import"./Tooltip.Cp89g2lg.js";const Se=()=>{const[v,j]=r.useState(!1),[k,S]=r.useState(!1),[E,V]=r.useState(""),[F,G]=r.useState(""),[l,R]=r.useState(null),[p,I]=r.useState([]),[g,f]=r.useState("loading"),[P,y]=r.useState(-1),i=z.useRef([]);if(r.useEffect(()=>{const t=async a=>{const n=a,{versionId:m,tag:N,galaxyId:o}=n.detail;i.current.forEach(s=>clearTimeout(s)),i.current=[],R(null),I([]),y(-1),S(!1),f("loading"),V(N),G(o),j(!0);try{const s=await $(m);R(s);const L=s.users.map(async d=>{const x=await q(d.id);return x?{...x,earnedStars:d.stars,roles:d.roles}:null}),b=(await Promise.all(L)).filter(d=>d!==null);I(b);const M=setTimeout(()=>{f("users"),y(0)},2e3);i.current.push(M),b.forEach((d,x)=>{const _=setTimeout(()=>{if(y(x),x===b.length-1){const A=setTimeout(()=>{f("topUser");const O=setTimeout(()=>{f("complete")},2e3);i.current.push(O)},1e3);i.current.push(A)}},1e3*(x+1));i.current.push(_)}),f("summary")}catch(s){console.error("Error in solar forge:",s),j(!1)}};return window.addEventListener(T.VERSION_RELEASED,t),()=>{window.removeEventListener(T.VERSION_RELEASED,t),i.current.forEach(a=>clearTimeout(a)),i.current=[]}},[]),r.useEffect(()=>{if(v&&!k){let t=function(o,s){return Math.random()*(s-o)+o};S(!0);const a=3e3,n=Date.now()+a,m={startVelocity:30,spread:360,ticks:60,zIndex:9999},N=setInterval(function(){const o=n-Date.now();if(o<=0){clearInterval(N);return}const s=50*(o/a);D({...m,particleCount:s,origin:{x:t(.1,.3),y:Math.random()-.2}}),D({...m,particleCount:s,origin:{x:t(.7,.9),y:Math.random()-.2}})},250)}},[v,k]),!v)return null;const c=p.length>0?p[0]:null,C=`/project?galaxy=${F}`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-black/50 backdrop-blur-sm z-[100]",onClick:()=>{g==="complete"&&j(!1)}}),e.jsx("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[101] flex items-center justify-center w-full max-w-2xl px-4",children:e.jsx(B,{title:"Version Released!",titleCenter:!0,children:e.jsxs("div",{className:"space-y-6",children:[l&&g!=="loading"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"text-xl font-bold text-slate-700 dark:text-slate-300",children:["Resolved"," ",e.jsx(u,{value:l.totalIssues,locales:"en-US",format:{useGrouping:!1},className:"inline-block"})," ","issues"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Users"}),e.jsx(u,{value:p.length,locales:"en-US",format:{useGrouping:!1},className:"text-xl font-semibold text-slate-700 dark:text-slate-300"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[h({iconType:"sunshine",className:"w-4 h-4"}),"Sunshines"]}),e.jsx(u,{value:l.totalSunshines,locales:"en-US",format:{useGrouping:!0},className:"text-xl font-semibold text-amber-600 dark:text-amber-400"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[h({iconType:"star",className:"w-4 h-4"}),"Stars"]}),e.jsx(u,{value:l.totalStars,locales:"en-US",format:{useGrouping:!1,minimumFractionDigits:1,maximumFractionDigits:6},className:"text-xl font-semibold text-yellow-600 dark:text-yellow-400"})]})]})]}),l&&p.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300 text-center",children:"Stars Distributed"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:p.map((t,a)=>e.jsxs("div",{className:w("flex items-center justify-between p-3 rounded-lg border transition-all duration-500",a<=P?"opacity-100 translate-x-0 border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50":"opacity-0 -translate-x-4 pointer-events-none"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{user:t}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-800 dark:text-slate-200",children:t.nickname||t.email?.split("@")[0]||"Unknown"}),e.jsx("div",{className:"flex gap-1 mt-1",children:t.roles.map((n,m)=>e.jsx("span",{className:w("text-xs px-2 py-0.5 rounded",n==="author"&&"bg-blue-500 text-white",n==="contributor"&&"bg-purple-500 text-white",n==="maintainer"&&"bg-green-500 text-white"),children:n},m))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h({iconType:"star",className:"w-5 h-5 text-yellow-500 dark:text-yellow-400"}),e.jsx(u,{value:t.earnedStars,locales:"en-US",format:{useGrouping:!1,minimumFractionDigits:1,maximumFractionDigits:6},className:"text-lg font-semibold text-yellow-600 dark:text-yellow-400"})]})]},t._id))})]}),l&&c&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300",children:"Top Receiver"}),e.jsxs("div",{className:"flex flex-col items-center p-6 rounded-lg border-2 border-yellow-400 dark:border-yellow-500 bg-yellow-50/50 dark:bg-yellow-900/20",children:[e.jsx(U,{user:c}),e.jsx("div",{className:"mt-4 font-bold text-xl text-slate-800 dark:text-slate-200",children:c.nickname||c.email?.split("@")[0]||"Unknown"}),e.jsx("div",{className:"flex gap-2 mt-2",children:c.roles.map((t,a)=>e.jsx("span",{className:w("text-sm px-3 py-1 rounded font-semibold",t==="author"&&"bg-blue-500 text-white",t==="contributor"&&"bg-purple-500 text-white",t==="maintainer"&&"bg-green-500 text-white"),children:t},a))}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[h({iconType:"star",className:"w-6 h-6 text-yellow-500 dark:text-yellow-400"}),e.jsx(u,{value:c.earnedStars,locales:"en-US",format:{useGrouping:!1,minimumFractionDigits:1,maximumFractionDigits:6},className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400"})]})]})]}),l&&g==="complete"&&e.jsx("div",{className:"flex justify-center",children:e.jsx(H,{uri:C,children:e.jsx(Y,{variant:"primary",size:"lg",children:"Put star in Galaxy"})})}),(!l||g==="loading")&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-lg text-slate-600 dark:text-slate-400",children:l?"Loading results...":"Processing solar forge..."}),E&&e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-500 mt-2",children:["Version: ",E]})]})]})})})]})};export{Se as default};
