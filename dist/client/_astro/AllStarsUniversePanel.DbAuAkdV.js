import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.DxhH1ShK.js";import{c as z,g as B}from"./utils.BnlJtBIq.js";import{C as m}from"./Tooltip.CRI7KqtE.js";import{I as L}from"./InfoPanel.Cb1x0uNg.js";import{B as x}from"./Button.BK-c6KtM.js";import{C as $}from"./Link.BGo-y1Vn.js";import{a as V}from"./galaxy.DW2RRtdf.js";import{a as A}from"./virtual.VUcB3V37.js";import"./index.C2SuE_cr.js";import"./index.CqUFkXl9.js";import"./slot.RkfkL2mj.js";import"./proxy.D4YeN7SK.js";import"./index.CG_O7YBG.js";import"./Panel.BFyw-rTz.js";import"./ripple.8VKTSqqU.js";import"./icon.Df9DBUhx.js";import"./accordion.Dr61eiHV.js";import"./accordion.CpVAuD1l.js";import"./useControlledState.CmDsCfE3.js";import"./index.DpQ8kv17.js";import"./index.Du2_2VfY.js";import"./createLucideIcon.C1tpinp8.js";import"./ElectricBorder.DAWLx7iV.js";import"./auth.C6MmFFld.js";import"./client.B9YBqyHK.js";const ue=({galaxyId:l,galaxyX:d=0,galaxyY:c=0,universeBounds:U,maintainerId:h,currentUserId:u})=>{const[p,b]=s.useState(!1),[r,f]=s.useState(d),[o,y]=s.useState(c),[v,w]=s.useState([]),G=h&&u&&h===u;s.useEffect(()=>{(async()=>{try{const a=await A.getGalaxyPositionHistory({galaxyId:l});a.data?.success&&a.data.data&&w(a.data.data)}catch(a){console.error("Error loading position history:",a)}})()},[l]),s.useEffect(()=>{f(d),y(c)},[d,c]);const E=async()=>{b(!0);try{const t=await V(l);if(t.success){f(t.x),y(t.y);try{const a=await A.getGalaxyPositionHistory({galaxyId:l});a.data?.success&&a.data.data&&w(a.data.data)}catch(a){console.error("Error reloading position history:",a)}}else console.error("Failed to update coordinates:",t.error)}catch(t){console.error("Error updating coordinates:",t)}finally{b(!1)}},j=r===0&&o===0,R=r!==0||o!==0,i=0,g=1800,n=0,N=1e3,X=900,Y=500,k=g-i,M=N-n,C=(r-i)/k*100,S=(o-n)/M*100,H=(X-i)/k*100,P=(Y-n)/M*100;return e.jsx(L,{className:z("absolute bottom-4 md:bottom-auto md:top-[calc(20vh+60px)] left-24","w-full max-w-sm mx-auto","backdrop-blur-md bg-white/10 dark:bg-slate-900/10","border border-slate-200/30 dark:border-slate-700/30","rounded-3xl p-8","transition-all duration-300","hover:bg-white/20 dark:hover:bg-slate-900/20","hover:border-slate-300/50 dark:hover:border-slate-600/50","hover:shadow-xl hover:shadow-blue-500/20","self-start md:self-auto"),children:e.jsxs("div",{className:"flex flex-col items-center space-y-6 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"All Stars Universe"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:"Galaxy Coordination on the Ara All Stars Universe"})]}),e.jsxs("div",{className:"w-full space-y-2",children:[e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("span",{className:"font-semibold",children:"x:"})," ",r,", ",e.jsx("span",{className:"font-semibold",children:"y:"})," ",o]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:["Minimap: X: ",i," to ",g,", Y: ",n," to ",N]})]}),j&&e.jsx("div",{className:"w-full px-4 py-3 rounded-lg bg-yellow-50/50 dark:bg-yellow-900/20 border border-yellow-200/50 dark:border-yellow-700/50",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:["Galaxy is not visible in Ara "," ",e.jsx($,{uri:"/all-stars",className:"text-yellow-600 dark:text-yellow-400 hover:underline font-semibold",children:"All Stars"})," ","page."]})}),!j&&e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"relative w-full h-48 rounded-lg border-2 border-slate-300/50 dark:border-slate-600/50 bg-slate-50/30 dark:bg-slate-800/30 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 border border-slate-400/30 dark:border-slate-500/30"}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-yellow-500 dark:bg-yellow-400 border border-yellow-600 dark:border-yellow-500 shadow-lg transform -translate-x-1/2 -translate-y-1/2 z-10",style:{left:`${Math.max(0,Math.min(100,H))}%`,top:`${Math.max(0,Math.min(100,P))}%`},title:"Ara Centre (500, 900)",children:e.jsx("div",{className:"absolute inset-0 rounded-full bg-yellow-400 dark:bg-yellow-500 animate-pulse opacity-50"})}),e.jsx("div",{className:"absolute w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 border-2 border-white dark:border-slate-900 shadow-lg transform -translate-x-1/2 -translate-y-1/2 z-20",style:{left:`${Math.max(0,Math.min(100,C))}%`,top:`${Math.max(0,Math.min(100,S))}%`},children:e.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-400 dark:bg-blue-500 animate-ping opacity-75"})}),e.jsxs("div",{className:"absolute text-xs font-mono text-slate-700 dark:text-slate-300 bg-white/80 dark:bg-slate-900/80 px-2 py-1 rounded shadow-sm transform -translate-x-1/2 z-20",style:{left:`${Math.max(0,Math.min(100,C))}%`,top:`${Math.max(0,Math.min(100,S+5))}%`},children:["(",r,", ",o,")"]}),e.jsx("div",{className:"absolute text-[10px] font-mono text-yellow-700 dark:text-yellow-300 bg-yellow-100/80 dark:bg-yellow-900/80 px-1.5 py-0.5 rounded shadow-sm transform -translate-x-1/2 z-10",style:{left:`${Math.max(0,Math.min(100,H))}%`,top:`${Math.max(0,Math.min(100,P-3))}%`},children:"Ara Centre"})]})}),G?R?e.jsx(m,{content:"Galaxy position is already set. It can only be set once.",children:e.jsx("div",{className:"w-full",children:e.jsx(x,{variant:"primary",disabled:!0,className:"w-full",children:"Position Already Set"})})}):e.jsx(x,{onClick:E,variant:"primary",disabled:p,className:"w-full",children:p?"Setting Coordinates...":"Set Galaxy Randomly"}):e.jsx(m,{content:"Only Maintainer can call it, please sign in as the Galaxy Maintainer",children:e.jsx("div",{className:"w-full",children:e.jsx(x,{variant:"primary",disabled:!0,className:"w-full",children:"Set Galaxy Randomly"})})}),v.length>0&&e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-2",children:"Position History"}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:v.map((t,a)=>e.jsx(m,{content:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"font-semibold",children:["Position #",t.order]}),e.jsxs("div",{children:["X: ",t.x,", Y: ",t.y]}),t.txId&&e.jsx("div",{children:e.jsx($,{uri:B(t.txId),asNewTab:!0,className:"text-blue-400 hover:text-blue-300 underline",children:"View on Explorer"})})]}),children:e.jsx("button",{type:"button",className:`relative w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-500 
                                                   flex items-center justify-center
                                                   shadow-lg hover:shadow-xl transition-shadow
                                                   border border-blue-400 dark:border-blue-300
                                                   cursor-pointer
                                                   animate-pulse`,"aria-label":`Position #${t.order}`,style:{boxShadow:"0 0 4px rgba(59, 130, 246, 0.5), 0 0 8px rgba(59, 130, 246, 0.3), 0 0 12px rgba(59, 130, 246, 0.2)"},children:e.jsx("svg",{className:"w-2 h-2 text-white pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})})},t._id||a))})]})]})})};export{ue as default};
