import{j as T}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.DxhH1ShK.js";import{E as v}from"./ElectricBorder.BANsXwQj.js";import{g as y}from"./Button.CuXyr_i0.js";import{c as m}from"./utils.Lr0IsqiS.js";import{i as D,s as R,w as x,a as H,u as f,b as I,e as E,c as j,d as k}from"./index.CeIpCxKj.js";let h=!1;class w{receiveHandlerId(t){this.targetId=t}getHandlerId(){return this.targetId}subscribeToStateChange(t,e){return this.internalMonitor.subscribeToStateChange(t,e)}canDrop(){if(!this.targetId)return!1;D(!h,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return h=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{h=!1}}isOver(t){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,t):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.targetId=null,this.internalMonitor=t.getMonitor()}}class S{get connectTarget(){return this.dropTarget}reconnect(){const t=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();t&&this.disconnectDropTarget();const e=this.dropTarget;if(this.handlerId){if(!e){this.lastConnectedDropTarget=e;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=e,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,e,this.dropTargetOptions))}}receiveHandlerId(t){t!==this.handlerId&&(this.handlerId=t,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(t){this.dropTargetOptionsInternal=t}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!R(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(t){this.hooks=x({dropTarget:(e,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,H(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}}function A(r){return s.useMemo(()=>r.hooks.dropTarget(),[r])}function F(r){const t=f(),e=s.useMemo(()=>new S(t.getBackend()),[t]);return I(()=>(e.dropTargetOptions=r||null,e.reconnect(),()=>e.disconnectDropTarget()),[r]),e}function N(){const r=f();return s.useMemo(()=>new w(r),[r])}function B(r){const{accept:t}=r;return s.useMemo(()=>(D(r.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]),[t])}class q{canDrop(){const t=this.spec,e=this.monitor;return t.canDrop?t.canDrop(e.getItem(),e):!0}hover(){const t=this.spec,e=this.monitor;t.hover&&t.hover(e.getItem(),e)}drop(){const t=this.spec,e=this.monitor;if(t.drop)return t.drop(e.getItem(),e)}constructor(t,e){this.spec=t,this.monitor=e}}function L(r,t){const e=s.useMemo(()=>new q(r,t),[t]);return s.useEffect(()=>{e.spec=r},[r]),e}function P(r,t,e){const n=f(),o=L(r,t),i=B(r);I(function(){const[l,a]=E(i,o,n);return t.receiveHandlerId(l),e.receiveHandlerId(l),a},[n,t,o,e,i.map(d=>d.toString()).join("|")])}function Y(r,t){const e=j(r,t),n=N(),o=F(e.options);return P(e,n,o),[k(e.collect,n,o),A(o)]}const V=s.memo(function({id:t,accept:e,onDrop:n,className:o,roundedClassName:i,innerClassName:d,children:l,disabled:a=!1,onStateChange:u}){const[{isOver:g,canDrop:c},C]=Y({accept:e,drop:a?void 0:(p,M)=>n(p,M),canDrop:()=>!a,collect:p=>({isOver:p.isOver(),canDrop:!a&&p.canDrop()})});s.useEffect(()=>{u&&u({isOver:g,canDrop:c})},[g,c,u]);const O=g&&c,b=i?void 0:8;return T.jsx("div",{ref:C,id:t,className:m("flex items-center justify-center h-full w-full transition-colors",O?"border-2 border-emerald-400/80":c?"border-2 border-blue-400/70":"border-2 border-transparent",i,o),"data-testid":t,children:T.jsx(v,{color:y("primary").colorFrom,speed:1,chaos:.5,thickness:2,style:{borderRadius:b},className:m("w-full h-full flex items-center justify-center px-4 py-2 text-sm",i,d),disabled:!c,children:l})})});export{V as C};
