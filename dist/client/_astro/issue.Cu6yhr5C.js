import{I as l,a as c}from"./issue.CJErfNqu.js";import{a as r}from"./virtual.VUcB3V37.js";import{a as I}from"./star.J0JRTi5O.js";function n(t){window.dispatchEvent(new CustomEvent(l.ISSUE_UPDATE,{detail:t}))}function f(t){window.dispatchEvent(new CustomEvent(l.ISSUE_CREATED,{detail:t}))}function w(){window.dispatchEvent(new CustomEvent(l.ISSUE_UNPATCHED))}async function h(t,s){let e=[];return s===c.SHINING?e=(await r.getShiningIssues({galaxyId:t})).data?.data||[]:s===c.PUBLIC?e=(await r.getPublicBacklogIssues({galaxyId:t})).data?.data||[]:e=(await r.getIssuesByGalaxy({galaxyId:t,tabKey:s})).data?.issues||[],e}async function a(t){try{const s=await r.getIssueById({issueId:t});return s.data?.success&&s.data.data?s.data.data:null}catch(s){return console.error("Error getting issue by id:",s),null}}async function p(t){try{if((await r.createIssue(t)).data?.success){const u=(await I(t.userId))?._id?.toString(),o=await h(t.galaxyId,t.sunshines>0?c.SHINING:c.PUBLIC),i=o.find(d=>d.title===t.title&&(u?d.author===u:!1))||o[o.length-1];if(i)return f(i),i}return null}catch(s){return console.error("Error creating issue:",s),null}}async function S(t){try{if((await r.updateIssue(t)).data?.success){const e=await a(t.issueId);return e&&n(e),!0}return!1}catch(s){return console.error("Error updating issue:",s),!1}}async function C(t){try{if((await r.patchIssue(t)).data?.success){const e=await a(t.issueId);return e&&n(e),!0}return!1}catch(s){return console.error("Error patching issue:",s),!1}}async function U(t){try{return(await r.unpatchIssue(t)).data?.success?(w(),!0):!1}catch(s){return console.error("Error unpatching issue:",s),!1}}async function b(t){try{if((await r.updateIssueSunshines(t)).data?.success){const e=await a(t.issueId);return e&&n(e),!0}return!1}catch(s){return console.error("Error updating issue sunshines:",s),!1}}async function B(t){try{if((await r.setContributor(t)).data?.success){const e=await a(t.issueId);return e&&n(e),!0}return!1}catch(s){return console.error("Error setting contributor:",s),!1}}async function v(t){try{if((await r.unsetContributor(t)).data?.success){const e=await a(t.issueId);return e&&n(e),!0}return!1}catch(s){return console.error("Error unsetting contributor:",s),!1}}export{h as a,U as b,p as c,S as d,b as e,a as g,C as p,B as s,v as u};
