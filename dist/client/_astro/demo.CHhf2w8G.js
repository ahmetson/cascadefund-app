import{a as o}from"./virtual.VUcB3V37.js";const n={email:"demo-email",users:"demo-users",role:"demo-role"},i={USER_CREATED:"demo-user-created",USER_DELETED:"demo-user-deleted",ROLE_CHANGED:"demo-role-change",DEMO_STEP_INCREMENTED:"demo-step-incremented"},f=()=>m(),h=()=>u(),D=async t=>{const e=await E(t);if(e.success&&e.users){const s="maintainer";l(t.trim(),e.users,s),window.dispatchEvent(new CustomEvent(i.USER_CREATED,{detail:{email:t.trim(),users:e.users,role:s}}))}return e},g=t=>{const{email:e,users:s}=u();e&&s&&(l(e,s,t),window.dispatchEvent(new CustomEvent(i.ROLE_CHANGED,{detail:{role:t}})))},S=async t=>{try{const e=await o.getDemoStep({email:t});return e.data?.success&&e.data.step!==void 0?e.data.step:null}catch(e){return console.error("Error getting demo step:",e),null}},w=async t=>{try{const e=await o.obtainSunshines(t);return e.data?.success?{success:!0,sunshines:e.data.sunshines,totalSunshines:e.data.totalSunshines}:{success:!1,error:e.data?.error||"Failed to obtain sunshines"}}catch(e){return console.error("Error obtaining sunshines:",e),{success:!1,error:"An error occurred while obtaining sunshines"}}},C=async t=>{try{const e=await o.incrementDemoStep(t);return console.log("incrementDemoStep result:",e,` for the ${t.expectedStep} step`),e.data?.success&&e.data.step!==void 0?(window.dispatchEvent(new CustomEvent(i.DEMO_STEP_INCREMENTED,{detail:{step:e.data.step}})),{success:!0,step:e.data.step}):{success:!1,error:e.data?.error||"Failed to increment demo step"}}catch(e){return console.error("Error incrementing demo step:",e),{success:!1,error:"An error occurred while incrementing demo step"}}};function u(){const t=a(n.email),e=a(n.users),s=a(n.role);let r=null;if(e)try{r=JSON.parse(e)}catch{r=null}return{email:t,users:r,role:s}}function m(){const{email:t,users:e,role:s}=u();return!!(t&&e&&s)}function l(t,e,s,r=30){c(n.email,t,r),c(n.users,encodeURIComponent(JSON.stringify(e)),r),c(n.role,s,r)}async function E(t){try{const e=await o.start({email:t.trim()});return e.data?{success:!0,users:e.data.users}:{success:!1,error:e.error?.message||"Failed to start demo"}}catch(e){return console.error("Error calling start action:",e),{success:!1,error:"An error occurred while starting demo"}}}function a(t){if(typeof document>"u")return null;const s=`; ${document.cookie}`.split(`; ${t}=`);return s.length===2?decodeURIComponent(s.pop()?.split(";").shift()||""):null}function c(t,e,s=30){if(typeof document>"u")return;const r=new Date;r.setDate(r.getDate()+s);const d=r.toUTCString();document.cookie=`${t}=${e}; expires=${d}; path=/`}export{i as D,S as a,g as c,f as d,h as g,C as i,w as o,D as s};
