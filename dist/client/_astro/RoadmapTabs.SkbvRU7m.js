import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as t}from"./index.DxhH1ShK.js";import{C as Qe}from"./Tabs.BnX2U2Gu.js";import{B as Se}from"./Badge.CwoN8wRJ.js";import{R as Pe}from"./roadmap.DwIP75iC.js";import{B as Xe}from"./Panel.BDrWh8LJ.js";import{P as Ze}from"./PageLikePanel.guWiuL_Q.js";import{B as es}from"./Button.CuXyr_i0.js";import{C as z}from"./Tooltip.BWGh4r1w.js";import{g as K}from"./icon.DFuhwfpy.js";import{P as ss}from"./PanelFooter.2n65IKfH.js";import{F as ne}from"./PanelStat.bUqZu1sD.js";import{N as S}from"./NumberFlow-client-48rw3j0J.DO-Ted3l.js";import{R as ts,T as rs,a as as,b as ns}from"./index.Z0WCTbK0.js";import{C as Ce,a as Te}from"./checkbox.CZMLd1yr.js";import{A as M}from"./AuthStar.Dmg28nm4.js";import{A as is,P as os}from"./AvatarList.777ZjNOH.js";import{T as ls}from"./timeago-react.CCkgRyVe.js";import{C as cs}from"./DropTarget.DZsHsBzm.js";import{D as Ae,H as Ue}from"./index.CeIpCxKj.js";import{a as ds,g as us}from"./auth.C6MmFFld.js";import{g as q,d as ms}from"./issue.Cu6yhr5C.js";import{g as J,a as Le}from"./star.J0JRTi5O.js";import{u as fs,a as hs,m as xs,b as gs,r as ps,d as bs,g as js}from"./roadmap.Cq_m8jGZ.js";import{P as L,a as Me}from"./patch.CbMO86LR.js";import{c as Q,t as ie}from"./utils.Lr0IsqiS.js";import{u as vs}from"./useDrag.C9I1mCaR.js";import"./index.CG_O7YBG.js";import"./proxy.D4YeN7SK.js";import"./slot.Dc8ja7ZA.js";import"./eventTypes.j192VUKf.js";import"./ripple.MQee5g1d.js";import"./accordion.CkcBKuZR.js";import"./accordion.Du3ry5_a.js";import"./use-controlled-state.CxrLW6JS.js";import"./index.TaQMmt2C.js";import"./index.C2SuE_cr.js";import"./index.CqUFkXl9.js";import"./index.pjxe1RjL.js";import"./createLucideIcon.C1tpinp8.js";import"./PanelAction.DEFdBo1-.js";import"./Link.k33VB9n9.js";import"./ElectricBorder.BANsXwQj.js";import"./clsx.B-dksMZM.js";import"./index.DXWCtkbr.js";import"./index.3ks74Brc.js";import"./virtual.VUcB3V37.js";import"./client.B9YBqyHK.js";import"./issue.CJErfNqu.js";const ys=({author:l,createdTime:g,className:D=""})=>{if(!l&&!g)return null;const C=g?typeof g=="number"?new Date(g*1e3):typeof g=="string"?new Date(g):g:null;return e.jsxs("div",{className:`flex justify-end items-center space-x-1 text-slate-600 dark:text-slate-400 gap-1 text-xs mb-2 ${D}`,children:[l&&e.jsxs(e.Fragment,{children:["By ",Array.isArray(l)?e.jsx(is,{contributors:l,showLastRating:!0}):e.jsxs(e.Fragment,{children:[e.jsx(M,{src:l?.icon,uri:l?.uri,className:"w-7! h-7!"}),l.rating&&e.jsx(os,{...l.rating})]})]}),C&&e.jsx(ls,{datetime:C})]})},oe=()=>e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-12 h-12",children:e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"0px",left:"18px",animationDelay:"0s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"6px",left:"30px",animationDelay:"0.1s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"18px",left:"36px",animationDelay:"0.2s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"30px",left:"30px",animationDelay:"0.3s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"36px",left:"18px",animationDelay:"0.4s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"30px",left:"6px",animationDelay:"0.5s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"18px",left:"0px",animationDelay:"0.6s"}}),e.jsx("div",{className:"w-3 h-3 bg-cascade-blue rounded-full absolute animate-ping",style:{top:"6px",left:"6px",animationDelay:"0.7s"}})]})})})}),ks=l=>l==="completed"?"archived":l==="active"||l==="planned"?"complete":l==="testing"||l==="release"||l==="archived"?l:"complete",Ns=({tag:l,createdTime:g,status:D,patches:C,maintainer:N,galaxy:T,_id:o})=>{const[n,X]=t.useState(ks(D)),[h,le]=t.useState(!1),[p,P]=t.useState(C),[ws,Es]=t.useState(null),[ce,Ss]=t.useState(null),{data:R,isPending:G}=ds.useSession(),[A,de]=t.useState(null),[_,ue]=t.useState(null),[Ps,me]=t.useState(!1),[Re,fe]=t.useState(null),[O,he]=t.useState(0),[xe,ge]=t.useState(!1),[_e,pe]=t.useState(!1),$=t.useRef(0);t.useEffect(()=>{N&&typeof N=="string"?(me(!0),J(N).then(async s=>{if(s&&(de(s),s.userId)){const r=await us(s.userId);r&&ue(r)}}).catch(s=>{console.error("Error fetching maintainer:",s)}).finally(()=>{me(!1)})):(de(null),ue(null))},[N]),t.useEffect(()=>{if(p.length===0){he(0);return}ge(!0),(async()=>{try{const r=p.map(i=>q(i.id)),x=await Promise.all(r);p.some((i,m)=>{const u=x[m];return u&&(i.sunshines===void 0||i.sunshines===null||i.sunshines!==u.sunshines)})&&P(i=>{const m=i.map((d,k)=>{const v=x[k];return v&&(d.sunshines===void 0||d.sunshines===null||d.sunshines!==v.sunshines)?{...d,sunshines:v.sunshines||0}:d});return m.some((d,k)=>d.sunshines!==i[k]?.sunshines)?m:i});const b=x.reduce((i,m)=>m?i+(m.sunshines||0):i,0);he(b)}catch(r){console.error("Error fetching sunshines from patches:",r)}finally{ge(!1)}})()},[p]),t.useEffect(()=>{if(G)return;const s=R?.user;s?.id?Le(s.id).then(r=>{r&&fe(r)}).catch(r=>{console.error("Error fetching current user:",r)}):fe(null)},[R,G]),t.useEffect(()=>{if(!o)return;const s=x=>{const a=x,{fromVersionId:b,toVersionId:i,patch:m}=a.detail;b===o&&i!==o?P(u=>u.filter(d=>d.id!==m.id)):i===o&&b!==o&&P(u=>u.some(d=>d.id===m.id)?u:[...u,m])},r=x=>{const a=x,{versionId:b,patch:i}=a.detail;b===o&&P(m=>m.filter(u=>u.id!==i.id))};return window.addEventListener(L.PATCH_UPDATE,s),window.addEventListener(L.PATCH_REMOVED,r),()=>{window.removeEventListener(L.PATCH_UPDATE,s),window.removeEventListener(L.PATCH_REMOVED,r)}},[o]);const be=t.useMemo(()=>p.filter(s=>s.completed).length,[p]),je=t.useMemo(()=>p.filter(s=>s.tested).length,[p]),I=t.useMemo(()=>p.length,[p]),Ie=t.useMemo(()=>O>0?O/180:0,[O]),Ve=s=>{switch(s){case"complete":return"bg-blue-100/10 dark:bg-blue-900/20 border-blue-300 dark:border-blue-500/30";case"testing":return"bg-amber-100/10 dark:bg-amber-900/20 border-amber-300 dark:border-amber-500/30";case"release":return"bg-teal-100/10 dark:bg-teal-900/20 border-teal-300 dark:border-teal-500/30";case"archived":return"bg-green-100/10 dark:bg-green-900/20 border-green-300 dark:border-green-500/30";default:return"bg-slate-100/10 dark:bg-slate-900/20 border-slate-300 dark:border-slate-500/30"}},He=t.useMemo(()=>{if(!A)return;const s=_?.name||_?.username||_?.email?.split("@")[0]||"Unknown",r=_?.image;return{uri:`/star?id=${A._id}`,children:s,icon:r}},[A,_]),V=Re?._id?.toString(),Z=typeof N=="string"?N:A?._id?.toString(),j=t.useMemo(()=>V&&Z&&V===Z,[V,Z]),Be=(s,r)=>{switch(s){case"complete":return"Move to testing";case"testing":return r?"Ready to release":"Testing in progress";case"release":return"Release";case"archived":return"Archived";default:return"Check"}},ee=I>0,Fe=ee?be===I:!1,Ge=ee?je===I:!1,se=Fe,U=Ge,Oe=n==="complete"?"Completed":"Tested",te=n==="complete"?be:je,re=A?e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"Maintainer"}),e.jsx(M,{star:A}),e.jsx("span",{children:"is reviewing the patches."})]}):"Maintainer controls this action.",ve=(()=>{if(n==="archived")return"Version is archived";if(n==="complete"){if(!ee)return"No patches found. Add patches first";if(!se)return"All patches must be completed before testing";if(!j)return re}if(n==="testing"){if(!j)return re;if(!U)return"Mark every patch as tested to proceed"}if(n==="release"&&!j)return re})(),ye=h||n==="archived"||n==="complete"&&(!j||!se)||n==="testing"&&(!j||!U)||n==="release"&&!j,Y=t.useCallback(async s=>{if(!o)return!1;le(!0);try{return await fs({versionId:o,status:s})?(X(s),!0):(console.error("Error updating status"),!1)}catch(r){return console.error("Error calling API:",r),!1}finally{le(!1)}},[o]),$e=async()=>{if(!(h||!o)&&n!=="archived"){if(n==="complete"){if(!j||!se)return;await Y("testing");return}if(n==="testing"){if(!j||!U)return;await Y("release");return}if(n==="release"){if(!j||!o)return;await bs({versionId:o,tag:l,galaxyId:T});return}}};t.useEffect(()=>{n==="testing"&&U&&!h&&j&&Y("release")},[n,U,h,j,Y]);const Ye=async(s,r,x=!1)=>{try{const a=R?.user;if(!a?.email){console.error("No authenticated user found");return}const b=await q(s.id);if(!b){alert("Internal error: issue not found");return}const i=b.listHistory||[],m=i.includes(Me),u=i.find(y=>y.startsWith("version-")),d=u?u.replace("version-",""):"",v=[...i.filter(y=>y!==Me&&!y.startsWith("version-")),`version-${r}`];if(!await ms({issueId:s.id,email:a.email,listHistory:v})){console.error("Failed to update issue");return}const E=p.filter(y=>y.id!==s.id),f={id:s.id,title:s.title,completed:x,tested:!1,sunshines:b.sunshines||0};E.push(f),await gs(r,E),d&&await ps({patchId:s.id,versionId:d}),P(E),m?window.dispatchEvent(new CustomEvent(L.PATCH_CREATED,{detail:{patch:f,versionId:r}})):d&&window.dispatchEvent(new CustomEvent(L.PATCH_UPDATE,{detail:{fromVersionId:d,toVersionId:r,patch:f}}))}catch(a){console.error("Error changing patch list:",a)}},ke=t.memo(({patch:s})=>{const[r,x]=t.useState(s.completed||!1),[a,b]=t.useState(null),[i,m]=t.useState(null),[u,d]=t.useState(null),[k,v]=t.useState(null),[w,H]=t.useState(!1),[E,f]=t.useState(!1),[{opacity:y,isDragging:W},B]=vs(()=>({type:"patch",item:{id:s.id,title:s.title,sunshines:s.sunshines,versionId:o||"",completed:r},collect:c=>({opacity:c.isDragging()?.4:1,isDragging:c.isDragging()})}),[s.id,s.title,s.sunshines,o,r]);t.useEffect(()=>{x(s.completed||!1)},[s.completed]),t.useEffect(()=>{H(!0),q(s.id).then(c=>{c&&b(c)}).catch(c=>{console.error("Error fetching issue:",c)}).finally(()=>{H(!1)})},[s.id]),t.useEffect(()=>{if(G)return;const c=R?.user;c?.id?Le(c.id).then(F=>{F&&m(F)}).catch(F=>{console.error("Error fetching current user:",F)}):m(null)},[R,G]),t.useEffect(()=>{a?.contributor&&typeof a.contributor=="string"?J(a.contributor).then(c=>{c&&d(c)}).catch(c=>{console.error("Error fetching contributor:",c)}):d(null)},[a?.contributor]),t.useEffect(()=>{a?.maintainer&&typeof a.maintainer=="string"?J(a.maintainer).then(c=>{c&&v(c)}).catch(c=>{console.error("Error fetching maintainer:",c)}):v(null)},[a?.maintainer]),t.useEffect(()=>{W?($.current+=1,pe(!0)):($.current=Math.max(0,$.current-1),$.current===0&&pe(!1))},[W]);const We=async()=>{if(!(E||!o)){f(!0);try{const c=!r;await hs({versionId:o,patchId:s.id,complete:c})?(x(c),P(Je=>Je.map(ae=>ae.id===s.id?{...ae,completed:c}:ae))):console.error("Error toggling patch completion")}catch(c){console.error("Error calling completePatch:",c)}finally{f(!1)}}},Ee=i&&a?.contributor&&i._id===a.contributor,ze=i&&a?.maintainer&&i._id===a.maintainer,Ke=!(r&&(ze||Ee)||!r&&Ee),qe=()=>w?e.jsx("div",{className:"text-sm",children:"Loading..."}):a?a.contributor===i?._id&&!r?e.jsx("div",{className:"text-sm",children:"You are a contributor. Mark as completed."}):a.contributor!==i?._id&&!r?e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"contributor"}),u&&e.jsx(M,{star:u}),e.jsx("span",{children:"is working on this issue :)"})]}):r&&(a.maintainer===i?._id||a.contributor===i?._id)?e.jsx("div",{className:"text-sm",children:"Unmark if the issue isn't solved"}):r&&a.maintainer!==i?._id&&a.contributor!==i?._id?e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"contributor"}),u&&e.jsx(M,{star:u}),e.jsx("span",{children:"worked."}),e.jsx("span",{children:"maintainer"}),k&&e.jsx(M,{star:k}),e.jsx("span",{children:"reviewed."})]}):e.jsx("div",{className:"text-sm",children:"Patch completion status"}):e.jsx("div",{className:"text-sm",children:"Issue not found"});return e.jsxs("div",{ref:B,"data-testid":s.id,style:{opacity:y},className:Q("cursor-move border-1 border-amber-300/80 hover:border-amber-400","dark:border-amber-400/70 dark:hover:border-amber-300/90","bg-amber-50/50 dark:bg-amber-900/20","transition-colors p-2 border-dashed rounded-md","flex items-center justify-between gap-2"),children:[e.jsx(z,{content:qe(),children:e.jsx(Ce,{checked:r,disabled:Ke||n!=="complete"||E,onCheckedChange:We,className:"w-4 h-4 rounded-sm border-2 border-slate-400 dark:border-slate-600 bg-white dark:bg-slate-600 data-[state=checked]:bg-slate-600 dark:data-[state=checked]:bg-slate-400 data-[state=checked]:border-slate-600 dark:data-[state=checked]:border-slate-400 flex items-center justify-center",children:e.jsx(Te,{className:"w-3 h-3 text-white dark:text-slate-700"})})}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300 flex-1 truncate",children:ie(s.title)}),e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[K({iconType:"sunshine",className:"w-4 h-4",fill:"currentColor"}),e.jsx("span",{className:"text-xs font-semibold",children:e.jsx(S,{value:s.sunshines||0,locales:"en-US",format:{useGrouping:!1}})})]})]})});ke.displayName="MinimalDraggablePatch";const Ne=t.memo(({patch:s})=>{const[r,x]=t.useState(!!s.tested),[a,b]=t.useState(null),[i,m]=t.useState(null),[u,d]=t.useState(!1),[k,v]=t.useState(!1);t.useEffect(()=>{d(!0),q(s.id).then(f=>{f&&b(f)}).catch(f=>{console.error("Error fetching issue:",f)}).finally(()=>d(!1))},[s.id]),t.useEffect(()=>{a?.author&&typeof a.author=="string"&&J(a.author).then(f=>{f&&m(f)}).catch(f=>console.error("Error fetching author:",f))},[a?.author]);const w=V&&a?.author&&V===a.author,H=async()=>{if(k||n!=="testing"||!w||!o)return;v(!0);const f=!r;try{await xs(o,s.id,f)&&(x(f),P(W=>W.map(B=>B.id===s.id?{...B,tested:f}:B)))}catch(y){console.error("Error marking tested:",y)}finally{v(!1)}},E=()=>u?e.jsx("div",{className:"text-sm",children:"Loading..."}):a?w?w&&!r?e.jsx("div",{className:"text-sm",children:"Confirm this patch is tested"}):w&&r?e.jsx("div",{className:"text-sm",children:"Unmark if testing failed"}):e.jsx("div",{className:"text-sm",children:"Testing status"}):e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{children:"Only author"}),i&&e.jsx(M,{star:i}),e.jsx("span",{children:"can mark tested"})]}):e.jsx("div",{className:"text-sm",children:"Issue not found"});return e.jsxs("div",{className:Q("border-1 border-amber-300/80 dark:border-amber-400/70 bg-amber-50/50 dark:bg-amber-900/20","transition-colors p-2 border-dashed rounded-md","flex items-center justify-between gap-2"),children:[e.jsx(z,{content:E(),children:e.jsx(Ce,{checked:r,disabled:!w||k||n!=="testing",onCheckedChange:H,className:"w-4 h-4 rounded-sm border-2 border-slate-400 dark:border-slate-600 bg-white dark:bg-slate-600 data-[state=checked]:bg-teal-600 dark:data-[state=checked]:bg-teal-500 data-[state=checked]:border-teal-600 dark:data-[state=checked]:border-teal-400 flex items-center justify-center",children:e.jsx(Te,{className:"w-3 h-3 text-white dark:text-slate-700"})})}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300 flex-1 truncate",children:ie(s.title)}),e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[K({iconType:"sunshine",className:"w-4 h-4",fill:"currentColor"}),e.jsx("span",{className:"text-xs font-semibold",children:e.jsx(S,{value:s.sunshines||0,locales:"en-US",format:{useGrouping:!1}})})]})]})});Ne.displayName="MinimalTestablePatch";const we=t.memo(({patch:s})=>{const r=s.tested?"Tested":s.completed?"Completed":"Pending",x=s.tested?"bg-teal-100 text-teal-700 dark:bg-teal-900/40 dark:text-teal-200":s.completed?"bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-200":"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-200";return e.jsxs("div",{className:Q("cursor-not-allowed border border-dashed rounded-md p-2","bg-slate-50/50 dark:bg-slate-900/30 border-slate-200 dark:border-slate-600/70","flex items-center justify-between gap-2"),children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide",children:e.jsx("span",{className:Q("px-2 py-0.5 rounded-sm font-semibold",x),children:r})}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300 flex-1 truncate",children:ie(s.title)}),e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[K({iconType:"sunshine",className:"w-4 h-4",fill:"currentColor"}),e.jsx("span",{className:"text-xs font-semibold",children:e.jsx(S,{value:s.sunshines||0,locales:"en-US",format:{useGrouping:!1}})})]})]})});return we.displayName="MinimalStaticPatch",e.jsxs(Ze,{interactive:!1,title:l,rightHeader:n!=="archived"&&(()=>{const s=e.jsx(es,{variant:n==="release"&&!ye?"primary":"secondary",disabled:ye,onClick:$e,children:h?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(oe,{})}):Be(n,U)});return ve?e.jsx(z,{content:ve,children:s}):s})(),className:`w-full ${Ve(n)} mb-4`,children:[n!=="archived"&&e.jsxs("div",{className:"w-full p-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400 text-sm",children:Oe}),e.jsx(S,{value:te,locales:"en-US",format:{useGrouping:!1},className:"font-semibold text-slate-700 dark:text-slate-400 text-sm mb-0.2"})]}),e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Total Amount"}),e.jsx(S,{value:I,locales:"en-US",format:{useGrouping:!1},className:"font-semibold text-slate-700 dark:text-slate-400 text-sm mb-0.2"})]})]}),e.jsx("div",{className:"my-2",children:e.jsxs(ts,{value:[te],onValueChange:()=>{},max:I,min:0,step:1,className:"relative flex h-5 w-full touch-none select-none items-center",children:[e.jsx(rs,{className:"relative h-2 grow rounded-full bg-slate-200 dark:bg-slate-700 transition-colors",children:e.jsx(as,{className:"absolute h-full rounded-full bg-slate-600 dark:bg-teal-400/50 transition-all duration-300 ease-out"})}),e.jsx(ns,{className:"relative block h-5 w-5 rounded-full bg-gray-100/50 dark:bg-slate-400/80 shadow-md ring-2 ring-slate-400/20 dark:ring-slate-500/30 hover:ring-slate-500/40 dark:hover:ring-slate-400/50 transition-all focus:outline-none focus:ring-2 focus:ring-slate-500 dark:focus:ring-slate-400",children:e.jsx(S,{value:te,locales:"en-US",format:{useGrouping:!1},className:"absolute left-1/2 -translate-x-1/2 text-xs text-slate-600 dark:text-slate-700 font-semibold"})})]})})]}),e.jsxs("div",{className:"my-6",children:[n==="complete"?e.jsxs(e.Fragment,{children:[e.jsx(z,{content:"Patches are the issues with the contributor and common agreement.",children:e.jsx(Ae,{backend:Ue,children:e.jsx(cs,{id:`version-${o||"unknown"}`,accept:["patch","issue"],onDrop:s=>{if(!o)return;const r=s.completed!==void 0?s.completed:!1;Ye(s,o,r)},disabled:_e,children:e.jsxs("h4",{className:"text-sm mb-2 font-medium text-slate-700 dark:text-slate-400 flex items-center gap-1.5 cursor-help",children:[K({iconType:"info",className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),"Patches"]})})},o)}),e.jsx(Ae,{backend:Ue,children:e.jsx("ul",{className:"space-y-2 min-h-[100px] mb-2",children:p.map(s=>e.jsx("li",{children:e.jsx(ke,{patch:s})},s.id))})},`${o}-draggable`)]}):n==="testing"?e.jsx("ul",{className:"space-y-2 min-h-[100px] mb-2",children:p.map(s=>e.jsx("li",{children:e.jsx(Ne,{patch:s})},s.id))}):e.jsx("ul",{className:"space-y-2 min-h-[100px] mb-2",children:p.map(s=>e.jsx("li",{children:e.jsx(we,{patch:s})},s.id))}),ce&&e.jsx("div",{className:"mt-4 p-3 bg-green-50/10 border border-green-200 dark:border-green-700 rounded-xs text-green-700 dark:text-green-400 text-sm",children:ce}),e.jsx(ys,{author:He,createdTime:g})]}),e.jsxs(ss,{children:[e.jsx(ne,{iconType:"sunshine",hint:"Total sunshines from all patches",fill:!0,children:xe?e.jsx(oe,{}):e.jsx(S,{value:O,locales:"en-US",format:{useGrouping:!0}})}),e.jsx(ne,{iconType:"star",hint:"Stars calculated from sunshines (sunshines / 180)",fill:n==="archived",children:xe?e.jsx(oe,{}):e.jsx(S,{value:Ie,locales:"en-US",format:{useGrouping:!1,minimumFractionDigits:1,maximumFractionDigits:1}})}),e.jsx(ne,{iconType:n==="archived"?"star":"project",hint:"Version status",fill:n==="archived",children:n==="archived"?"Archived":n})]})]})},De=({versions:l})=>e.jsx(Xe,{className:"space-y-6 p-0! border-none! min-h-[50vh]",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:l.map(g=>e.jsx(Ns,{...g},g._id))})}),Nt=({galaxyId:l})=>{const[g,D]=t.useState([]),[C,N]=t.useState(!0),T=t.useCallback(async()=>{try{N(!0);const h=await js(l);D(h)}catch(h){console.error("Error fetching versions:",h)}finally{N(!1)}},[l]);t.useEffect(()=>{l&&T()},[l,T]),t.useEffect(()=>{const h=()=>{T()};return window.addEventListener(Pe.VERSION_CREATED,h),()=>{window.removeEventListener(Pe.VERSION_CREATED,h)}},[T]);const o=g.filter(h=>h.status!=="archived"),n=g.filter(h=>h.status==="archived");if(C)return e.jsx("div",{className:"text-center py-8",children:"Loading roadmap..."});const X=[{label:e.jsxs("div",{className:"",children:["Roadmap ",e.jsx(Se,{variant:"gray",children:o.length})]}),key:"roadmap",content:e.jsx(De,{versions:o})},{label:e.jsxs("div",{className:"",children:["Archive ",e.jsx(Se,{variant:"gray",children:n.length})]}),key:"archive",content:e.jsx(De,{versions:n})}];return e.jsx(Qe,{activeTab:"roadmap",tabs:X})};export{Nt as default};
