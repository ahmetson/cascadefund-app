import{j as M}from"./jsx-runtime.D_zvdyIk.js";import{r as d}from"./index.DxhH1ShK.js";import{a as $,c as I}from"./utils.Lr0IsqiS.js";const q=["shift","alt","meta","mod","ctrl","control"],W={esc:"escape",return:"enter",left:"arrowleft",right:"arrowright",up:"arrowup",down:"arrowdown",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function k(e){return(W[e.trim()]||e.trim()).toLowerCase().replace(/key|digit|numpad/,"")}function N(e){return q.includes(e)}function K(e,t=","){return e.toLowerCase().split(t)}function C(e,t="+",n=">",a=!1,s){let i=[],c=!1;e=e.trim(),e.includes(n)?(c=!0,i=e.toLocaleLowerCase().split(n).map(f=>k(f))):i=e.toLocaleLowerCase().split(t).map(f=>k(f));const w={alt:i.includes("alt"),ctrl:i.includes("ctrl")||i.includes("control"),shift:i.includes("shift"),meta:i.includes("meta"),mod:i.includes("mod"),useKey:a},u=i.filter(f=>!q.includes(f));return{...w,keys:u,description:s,isSequence:c,hotkey:e}}typeof document<"u"&&(document.addEventListener("keydown",e=>{e.code!==void 0&&P([k(e.code)])}),document.addEventListener("keyup",e=>{e.code!==void 0&&T([k(e.code)])})),typeof window<"u"&&(window.addEventListener("blur",()=>{g.clear()}),window.addEventListener("contextmenu",()=>{setTimeout(()=>{g.clear()},0)}));const g=new Set;function S(e){return Array.isArray(e)}function z(e,t=","){return(S(e)?e:e.split(t)).every(n=>g.has(n.trim().toLowerCase()))}function P(e){const t=Array.isArray(e)?e:[e];g.has("meta")&&g.forEach(n=>!N(n)&&g.delete(n.toLowerCase())),t.forEach(n=>g.add(n.toLowerCase()))}function T(e){const t=Array.isArray(e)?e:[e];e==="meta"?g.clear():t.forEach(n=>g.delete(n.toLowerCase()))}function G(e,t,n){(typeof n=="function"&&n(e,t)||n===!0)&&e.preventDefault()}function Q(e,t,n){return typeof n=="function"?n(e,t):n===!0||n===void 0}const U=["input","textarea","select","searchbox","slider","spinbutton","menuitem","menuitemcheckbox","menuitemradio","option","radio","textbox"];function V(e){return D(e,U)}function D(e,t=!1){const{target:n,composed:a}=e;let s,i;return X(n)&&a?(s=e.composedPath()[0]&&e.composedPath()[0].tagName,i=e.composedPath()[0]&&e.composedPath()[0].role):(s=n&&n.tagName,i=n&&n.role),S(t)?!!(s&&t&&t.some(c=>c.toLowerCase()===s.toLowerCase()||c===i)):!!(s&&t&&t)}function X(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}function Y(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(n=>t.includes(n))||e.includes("*"):!0}const Z=(e,t,n=!1)=>{const{alt:a,meta:s,mod:i,shift:c,ctrl:w,keys:u,useKey:f}=t,{code:L,key:r,ctrlKey:b,metaKey:v,shiftKey:y,altKey:m}=e,l=k(L);if(f&&u?.length===1&&u.includes(r))return!0;if(!u?.includes(l)&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(l))return!1;if(!n){if(a!==m&&l!=="alt"||c!==y&&l!=="shift")return!1;if(i){if(!v&&!b)return!1}else if(s!==v&&l!=="meta"&&l!=="os"||w!==b&&l!=="ctrl"&&l!=="control")return!1}return u&&u.length===1&&u.includes(l)?!0:u?z(u):!u},_=d.createContext(void 0),J=()=>d.useContext(_);function H(e,t){return e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce((n,a)=>n&&H(e[a],t[a]),!0):e===t}const B=d.createContext({hotkeys:[],activeScopes:[],toggleScope:()=>{},enableScope:()=>{},disableScope:()=>{}}),ee=()=>d.useContext(B);function te(e){const t=d.useRef(void 0);return H(t.current,e)||(t.current=e),t.current}const j=e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},ne=typeof window<"u"?d.useLayoutEffect:d.useEffect;function re(e,t,n,a){const s=d.useRef(null),i=d.useRef(!1),c=Array.isArray(n)?Array.isArray(a)?void 0:a:n,w=S(e)?e.join(c?.delimiter):e,u=Array.isArray(n)?n:Array.isArray(a)?a:void 0,f=d.useCallback(t,u??[]),L=d.useRef(f);u?L.current=f:L.current=t;const r=te(c),{activeScopes:b}=ee(),v=J();return ne(()=>{if(r?.enabled===!1||!Y(b,r?.scopes))return;let y=[],m;const l=(o,R=!1)=>{if(!(V(o)&&!D(o,r?.enableOnFormTags))){if(s.current!==null){const h=s.current.getRootNode();if((h instanceof Document||h instanceof ShadowRoot)&&h.activeElement!==s.current&&!s.current.contains(h.activeElement)){j(o);return}}o.target?.isContentEditable&&!r?.enableOnContentEditable||K(w,r?.delimiter).forEach(h=>{if(h.includes(r?.splitKey??"+")&&h.includes(r?.sequenceSplitKey??">")){console.warn(`Hotkey ${h} contains both ${r?.splitKey??"+"} and ${r?.sequenceSplitKey??">"} which is not supported.`);return}const p=C(h,r?.splitKey,r?.sequenceSplitKey,r?.useKey,r?.description);if(p.isSequence){m=setTimeout(()=>{y=[]},r?.sequenceTimeoutMs??1e3);const x=p.useKey?o.key:k(o.code);if(N(x.toLowerCase()))return;y.push(x);const F=p.keys?.[y.length-1];if(x!==F){y=[],m&&clearTimeout(m);return}y.length===p.keys?.length&&(L.current(o,p),m&&clearTimeout(m),y=[])}else if(Z(o,p,r?.ignoreModifiers)||p.keys?.includes("*")){if(r?.ignoreEventWhen?.(o)||R&&i.current)return;if(G(o,p,r?.preventDefault),!Q(o,p,r?.enabled)){j(o);return}L.current(o,p),R||(i.current=!0)}})}},A=o=>{o.code!==void 0&&(P(k(o.code)),(r?.keydown===void 0&&r?.keyup!==!0||r?.keydown)&&l(o))},O=o=>{o.code!==void 0&&(T(k(o.code)),i.current=!1,r?.keyup&&l(o,!0))},E=s.current||c?.document||document;return E.addEventListener("keyup",O,c?.eventListenerOptions),E.addEventListener("keydown",A,c?.eventListenerOptions),v&&K(w,r?.delimiter).forEach(o=>v.addHotkey(C(o,r?.splitKey,r?.sequenceSplitKey,r?.useKey,r?.description))),()=>{E.removeEventListener("keyup",O,c?.eventListenerOptions),E.removeEventListener("keydown",A,c?.eventListenerOptions),v&&K(w,r?.delimiter).forEach(o=>v.removeHotkey(C(o,r?.splitKey,r?.sequenceSplitKey,r?.useKey,r?.description))),y=[],m&&clearTimeout(m)}},[w,r,b]),s}const ae=({className:e,children:t,overwrittenChildren:n,onPress:a})=>(re(n||t,()=>{a?.(n||t)},{enableOnFormTags:!0}),M.jsx("kbd",{className:I("kbd border border-gray-300 dark:border-gray-600 rounded-sm border-solid px-1 py-2 w-12 text-xs flex text-center items-center dark:bg-slate-500 text-gray-600 dark:text-gray-300 h-4!",e),children:$(t)}));export{ae as K,re as f};
